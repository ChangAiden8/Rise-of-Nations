PRC_create_wargoal_for_dongbei = {
	custom_effect_tooltip = PRC_create_wargoal_for_db_tt
	hidden_effect = {
		every_country = {
			limit = {
				any_owned_state = {
					OR = {
						region = 155
						region = 143
					}
				}
				NOT = { tag = ROOT }
			}
			ROOT = {
				create_wargoal = {
					target = PREV
					type = take_state_focus
				}
			}
		}
	}
}


### anchor_1 ###
gain_central_plain_wargoal = {
	custom_effect_tooltip = MCK_reclaim_central_plain_tt
	every_country = {
		limit = {
			any_owned_state = {
				OR = {
					region = 165
					region = 213
					region = 212
					region = 211
					region = 164
					region = 216
					region = 215
					region = 214
					region = 217
					region = 218
					region = 144
					region = 143
				}
				NOT = { state = 817 }
				NOT = { state = 612 }
				NOT = { state = 746 }
				NOT = { state = 326 }
				NOT = { state = 728 }
				NOT = { state = 729 }
			}
			NOT = { tag = ROOT }
		}
		ROOT = {
			create_wargoal = {
				target = PREV
				type = take_state_focus
			}
		}
	}
}
### anchor_2 ###

old_frontier_get_wargoal = {
	custom_effect_tooltip = MCK_restore_frontier_tt
	every_country = {
		limit = {
			any_owned_state = {
				OR = {
					region = 155
					region = 152
					region = 219
					region = 145
					region = 200
					state = 612
					state = 817
					state = 758
					state = 757
				}
			}
			NOT = { tag = ROOT }
		}
		ROOT = {
			create_wargoal = {
				target = PREV
				type = take_state_focus
			}
		}
	}
}
### anchor_3 ###

gain_fareast_wargoal = {
	custom_effect_tooltip = PRC_get_wargoal_for_fareast_tt
	hidden_effect = {
		every_country = {
			limit = {
				any_owned_state = {
					region = 148
				}
				NOT = { tag = ROOT }
			}
			ROOT = {
				create_wargoal = {
					target = PREV
					type = take_state_focus
				}
			}
		}
	}
}
### anchor_4 ###

KMT_north_plan_wargoal = {
	custom_effect_tooltip = KMT_north_plan_effect_tt
	hidden_effect = {
		every_country = {
			limit = {
				any_owned_state = {
					OR = {
						region = 143
						region = 155
					}
				}
				NOT = { 
					tag = ROOT 
					is_chinese_nations = yes
				}
			}
			ROOT = {
				create_wargoal = {
					target = PREV
					type = take_state_focus
				}
			}
		}
	}
}
### anchor_5 ###

add_xian_rejected_num = {
	if = {
		limit = {
			has_country_flag = {
				flag = KMT_xian_rejected_num
				value < 2
			}
		}
		set_country_flag = {
			flag = KMT_xian_rejected_num
			value = 1
		}
		else = {
			modify_country_flag = {
				flag = KMT_xian_rejected_num
				value = 1
			}
		}
	}
}


withdraw_from_all_wars_with_puppet = {
	if = {
		limit = {
			has_government = neutrality
		}
		random_other_country = {
			limit = {
				has_government = neutrality
				has_war = no
				exists = yes
			}
			puppet = ROOT
			end_puppet = ROOT
		}
		if = {
			limit = {
				NOT = {
					any_country = {
						NOT = { tag = ROOT }
						has_government = neutrality
						has_war = no
						exists = yes
					}
				}
			}
			random_other_country = {
				limit = {
					has_war = no
				}
				puppet = ROOT
				end_puppet = ROOT
			}
		}
		add_popularity = {
			ideology = neutrality
			popularity = 0.95
		}
	}
	if = {
		limit = {
			has_government = fascism
		}
		random_other_country = {
			limit = {
				has_government = fascism
				has_war = no
				exists = yes
			}
			puppet = ROOT
			end_puppet = ROOT
		}
		if = {
			limit = {
				NOT = {
					any_country = {
						NOT = { tag = ROOT }
						has_government = fascism
						has_war = no
						exists = yes
					}
				}
			}
			random_other_country = {
				limit = {
					has_war = no
				}
				puppet = ROOT
				end_puppet = ROOT
			}
		}
		add_popularity = {
			ideology = fascism
			popularity = 0.95
		}
	}
	if = {
		limit = {
			has_government = communism
		}
		random_other_country = {
			limit = {
				has_government = communism
				has_war = no
				exists = yes
			}
			puppet = ROOT
			end_puppet = ROOT
		}
		if = {
			limit = {
				NOT = {
					any_country = {
						NOT = { tag = ROOT }
						has_government = communism
						has_war = no
						exists = yes
					}
				}
			}
			random_other_country = {
				limit = {
					has_war = no
				}
				puppet = ROOT
				end_puppet = ROOT
			}
		}
		add_popularity = {
			ideology = communism
			popularity = 0.95
		}
	}
	if = {
		limit = {
			has_government = democratic
		}
		random_other_country = {
			limit = {
				has_government = democratic
				has_war = no
				exists = yes
			}
			puppet = ROOT
			end_puppet = ROOT
		}
		if = {
			limit = {
				NOT = {
					any_country = {
						NOT = { tag = ROOT }
						has_government = democratic
						has_war = no
						exists = yes
					}
				}
			}
			random_other_country = {
				limit = {
					has_war = no
				}
				puppet = ROOT
				end_puppet = ROOT
			}
		}
		add_popularity = {
			ideology = democratic
			popularity = 0.95
		}
	}
	if = {
		limit = {
			is_in_faction = yes
		}
		random_country = {
			limit = {
				is_faction_leader = yes
				is_in_faction_with = ROOT
			}
			remove_from_faction = ROOT
		}
	}
}

increase_jap_awareness = {
	custom_effect_tooltip = increase_jap_awareness_tt
	set_temp_variable = { MCK_temp_awareness = MCK_awareness }
	add_to_temp_variable = { MCK_temp_awareness = 1 }
	if = {
		limit = { check_variable = { MCK_temp_awareness > 19 }}
		custom_effect_tooltip = MCK_jap_will_demand_submission_tt
		OVERLORD = { country_event = jap.79 }
		else = {
			if = {
				limit = { 
					check_variable = { MCK_temp_awareness > 14 }
					NOT = {
						has_idea = jap_aware_3
					}
				}
				custom_effect_tooltip = MCK_increase_awareness_modifier_tt
				custom_effect_tooltip = MCK_awareness_3
				hidden_effect = {
					remove_ideas = jap_aware_2
					add_ideas = jap_aware_3
				}
				else = {
					if = {
						limit = { 
							check_variable = { MCK_temp_awareness > 9 }
							NOT = {
								has_idea = jap_aware_2
							}
						}
						custom_effect_tooltip = MCK_increase_awareness_modifier_tt
						custom_effect_tooltip = MCK_awareness_2
						hidden_effect = {
							remove_ideas = jap_aware_3
							add_ideas = jap_aware_2
						}
					}
				}
			}
		}
	}
	add_to_variable = { MCK_awareness = 1 }
}

increase_jap_awareness2 = {
	custom_effect_tooltip = increase_jap_awareness2_tt
	set_temp_variable = { MCK_temp_awareness = MCK_awareness }
	add_to_temp_variable = { MCK_temp_awareness = 2 }
	if = {
		limit = { check_variable = { MCK_temp_awareness > 19 }}
		custom_effect_tooltip = MCK_jap_will_demand_submission_tt
		OVERLORD = { country_event = jap.79 }
		else = {
			if = {
				limit = { 
					check_variable = { MCK_temp_awareness > 14 }
					NOT = {
						has_idea = jap_aware_3
					}
				}
				custom_effect_tooltip = MCK_increase_awareness_modifier_tt
				custom_effect_tooltip = MCK_awareness_3
				hidden_effect = {
					remove_ideas = jap_aware_2
					add_ideas = jap_aware_3
				}
				else = {
					if = {
						limit = { 
							check_variable = { MCK_temp_awareness > 9 }
							NOT = {
								has_idea = jap_aware_2
							}
						}
						custom_effect_tooltip = MCK_increase_awareness_modifier_tt
						custom_effect_tooltip = MCK_awareness_2
						hidden_effect = {
							remove_ideas = jap_aware_3
							add_ideas = jap_aware_2
						}
					}
				}
			}
		}
	}
	add_to_variable = { MCK_awareness = 2 }
}

increase_jap_awareness3 = {
	custom_effect_tooltip = increase_jap_awareness3_tt
	set_temp_variable = { MCK_temp_awareness = MCK_awareness }
	add_to_temp_variable = { MCK_temp_awareness = 3 }
	if = {
		limit = { check_variable = { MCK_temp_awareness > 19 }}
		custom_effect_tooltip = MCK_jap_will_demand_submission_tt
		OVERLORD = { country_event = jap.79 }
		else = {
			if = {
				limit = { 
					check_variable = { MCK_temp_awareness > 14 }
					NOT = {
						has_idea = jap_aware_3
					}
				}
				custom_effect_tooltip = MCK_increase_awareness_modifier_tt
				custom_effect_tooltip = MCK_awareness_3
				hidden_effect = {
					remove_ideas = jap_aware_2
					add_ideas = jap_aware_3
				}
				else = {
					if = {
						limit = { 
							check_variable = { MCK_temp_awareness > 9 }
							NOT = {
								has_idea = jap_aware_2
							}
						}
						custom_effect_tooltip = MCK_increase_awareness_modifier_tt
						custom_effect_tooltip = MCK_awareness_2
						hidden_effect = {
							remove_ideas = jap_aware_3
							add_ideas = jap_aware_2
						}
					}
				}
			}
		}
	}
	add_to_variable = { MCK_awareness = 3 }
}

increase_jap_awareness4 = {
	custom_effect_tooltip = increase_jap_awareness4_tt
	set_temp_variable = { MCK_temp_awareness = MCK_awareness }
	add_to_temp_variable = { MCK_temp_awareness = 4 }
	if = {
		limit = { check_variable = { MCK_temp_awareness > 19 }}
		custom_effect_tooltip = MCK_jap_will_demand_submission_tt
		OVERLORD = { country_event = jap.79 }
		else = {
			if = {
				limit = { 
					check_variable = { MCK_temp_awareness > 14 }
					NOT = {
						has_idea = jap_aware_3
					}
				}
				custom_effect_tooltip = MCK_increase_awareness_modifier_tt
				custom_effect_tooltip = MCK_awareness_3
				hidden_effect = {
					remove_ideas = jap_aware_2
					add_ideas = jap_aware_3
				}
				else = {
					if = {
						limit = { 
							check_variable = { MCK_temp_awareness > 9 }
							NOT = {
								has_idea = jap_aware_2
							}
						}
						custom_effect_tooltip = MCK_increase_awareness_modifier_tt
						custom_effect_tooltip = MCK_awareness_2
						hidden_effect = {
							remove_ideas = jap_aware_3
							add_ideas = jap_aware_2
						}
					}
				}
			}
		}
	}
	add_to_variable = { MCK_awareness = 4 }
}

lower_awareness2 = {
	custom_effect_tooltip = lower_awareness2_tt
	set_temp_variable = { MCK_temp_awareness = MCK_awareness }
	subtract_from_temp_variable = { MCK_temp_awareness = 2 }
	if = {
		limit = { 
			NOT = { check_variable = { MCK_temp_awareness > 9 }}
			has_idea = jap_aware_2
		}
		custom_effect_tooltip = MCK_increase_awareness_modifier_tt
		custom_effect_tooltip = MCK_awareness_none_tt
		hidden_effect = {
			remove_ideas = jap_aware_2
		}
		else = {
			if = {
				limit = { 
					NOT = {check_variable = { MCK_temp_awareness > 14 }}
					has_idea = jap_aware_3
				}
				custom_effect_tooltip = MCK_increase_awareness_modifier_tt
				custom_effect_tooltip = MCK_awareness_2_tt
				hidden_effect = {
					remove_ideas = jap_aware_3
				}
			}
		}
	}
	if = {
		limit = {
			check_variable = { MCK_temp_awareness < 0 }
		}
		set_variable = { MCK_awareness = 0 }
		else = {
			subtract_from_variable = { MCK_awareness = 2 }
		}
	}
}


KMT_take_pacific_wargoal = {
	custom_effect_tooltip = KMT_take_pacific_tt
	hidden_effect = {
		if = {
			limit = {
				526 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					526 = {
						owner = { is_puppet = no }
					}
				}
				526 = {
					owner = {
						save_event_target_as = KMTtakepac_526_owner
					}
				}
				else = {
					526 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_526_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				524 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					524 = {
						owner = { is_puppet = no }
					}
				}
				524 = {
					owner = {
						save_event_target_as = KMTtakepac_524_owner
					}
				}
				else = {
					524 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_524_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				528 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					528 = {
						owner = { is_puppet = no }
					}
				}
				528 = {
					owner = {
						save_event_target_as = KMTtakepac_528_owner
					}
				}
				else = {
					528 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_528_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				529 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					529 = {
						owner = { is_puppet = no }
					}
				}
				529 = {
					owner = {
						save_event_target_as = KMTtakepac_529_owner
					}
				}
				else = {
					529 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_529_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				530 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					530 = {
						owner = { is_puppet = no }
					}
				}
				530 = {
					owner = {
						save_event_target_as = KMTtakepac_530_owner
					}
				}
				else = {
					530 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_530_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				531 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					531 = {
						owner = { is_puppet = no }
					}
				}
				531 = {
					owner = {
						save_event_target_as = KMTtakepac_531_owner
					}
				}
				else = {
					531 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_531_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				532 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					532 = {
						owner = { is_puppet = no }
					}
				}
				532 = {
					owner = {
						save_event_target_as = KMTtakepac_532_owner
					}
				}
				else = {
					532 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_532_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				282 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					282 = {
						owner = { is_puppet = no }
					}
				}
				282 = {
					owner = {
						save_event_target_as = KMTtakepac_282_owner
					}
				}
				else = {
					282 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_282_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				535 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					535 = {
						owner = { is_puppet = no }
					}
				}
				535 = {
					owner = {
						save_event_target_as = KMTtakepac_535_owner
					}
				}
				else = {
					535 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_535_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				534 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					534 = {
						owner = { is_puppet = no }
					}
				}
				534 = {
					owner = {
						save_event_target_as = KMTtakepac_534_owner
					}
				}
				else = {
					534 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_534_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				533 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					533 = {
						owner = { is_puppet = no }
					}
				}
				533 = {
					owner = {
						save_event_target_as = KMTtakepac_533_owner
					}
				}
				else = {
					533 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_533_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				536 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					536 = {
						owner = { is_puppet = no }
					}
				}
				536 = {
					owner = {
						save_event_target_as = KMTtakepac_536_owner
					}
				}
				else = {
					536 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_536_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				555 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					555 = {
						owner = { is_puppet = no }
					}
				}
				555 = {
					owner = {
						save_event_target_as = KMTtakepac_555_owner
					}
				}
				else = {
					555 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_555_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				645 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					645 = {
						owner = { is_puppet = no }
					}
				}
				645 = {
					owner = {
						save_event_target_as = KMTtakepac_645_owner
					}
				}
				else = {
					645 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_645_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				525 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					525 = {
						owner = { is_puppet = no }
					}
				}
				525 = {
					owner = {
						save_event_target_as = KMTtakepac_525_owner
					}
				}
				else = {
					525 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_525_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				527 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					527 = {
						owner = { is_puppet = no }
					}
				}
				527 = {
					owner = {
						save_event_target_as = KMTtakepac_527_owner
					}
				}
				else = {
					527 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_527_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				648 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					648 = {
						owner = { is_puppet = no }
					}
				}
				648 = {
					owner = {
						save_event_target_as = KMTtakepac_648_owner
					}
				}
				else = {
					648 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_648_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				646 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					646 = {
						owner = { is_puppet = no }
					}
				}
				646 = {
					owner = {
						save_event_target_as = KMTtakepac_646_owner
					}
				}
				else = {
					646 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_646_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				638 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					638 = {
						owner = { is_puppet = no }
					}
				}
				638 = {
					owner = {
						save_event_target_as = KMTtakepac_638_owner
					}
				}
				else = {
					638 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_638_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				647 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					647 = {
						owner = { is_puppet = no }
					}
				}
				647 = {
					owner = {
						save_event_target_as = KMTtakepac_647_owner
					}
				}
				else = {
					647 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_647_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				684 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					684 = {
						owner = { is_puppet = no }
					}
				}
				684 = {
					owner = {
						save_event_target_as = KMTtakepac_684_owner
					}
				}
				else = {
					684 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_684_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				633 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					633 = {
						owner = { is_puppet = no }
					}
				}
				633 = {
					owner = {
						save_event_target_as = KMTtakepac_633_owner
					}
				}
				else = {
					633 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_633_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				632 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					632 = {
						owner = { is_puppet = no }
					}
				}
				632 = {
					owner = {
						save_event_target_as = KMTtakepac_632_owner
					}
				}
				else = {
					632 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_632_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				725 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					725 = {
						owner = { is_puppet = no }
					}
				}
				725 = {
					owner = {
						save_event_target_as = KMTtakepac_725_owner
					}
				}
				else = {
					725 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_725_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				639 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					639 = {
						owner = { is_puppet = no }
					}
				}
				639 = {
					owner = {
						save_event_target_as = KMTtakepac_639_owner
					}
				}
				else = {
					639 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_639_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				631 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					631 = {
						owner = { is_puppet = no }
					}
				}
				631 = {
					owner = {
						save_event_target_as = KMTtakepac_631_owner
					}
				}
				else = {
					631 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_631_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				642 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					642 = {
						owner = { is_puppet = no }
					}
				}
				642 = {
					owner = {
						save_event_target_as = KMTtakepac_642_owner
					}
				}
				else = {
					642 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_642_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				727 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					727 = {
						owner = { is_puppet = no }
					}
				}
				727 = {
					owner = {
						save_event_target_as = KMTtakepac_727_owner
					}
				}
				else = {
					727 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_727_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				630 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					630 = {
						owner = { is_puppet = no }
					}
				}
				630 = {
					owner = {
						save_event_target_as = KMTtakepac_630_owner
					}
				}
				else = {
					630 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_630_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				629 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					629 = {
						owner = { is_puppet = no }
					}
				}
				629 = {
					owner = {
						save_event_target_as = KMTtakepac_629_owner
					}
				}
				else = {
					629 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_629_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				643 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					643 = {
						owner = { is_puppet = no }
					}
				}
				643 = {
					owner = {
						save_event_target_as = KMTtakepac_643_owner
					}
				}
				else = {
					643 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_643_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				726 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					726 = {
						owner = { is_puppet = no }
					}
				}
				726 = {
					owner = {
						save_event_target_as = KMTtakepac_726_owner
					}
				}
				else = {
					726 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_726_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				641 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					641 = {
						owner = { is_puppet = no }
					}
				}
				641 = {
					owner = {
						save_event_target_as = KMTtakepac_641_owner
					}
				}
				else = {
					641 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_641_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				636 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					636 = {
						owner = { is_puppet = no }
					}
				}
				636 = {
					owner = {
						save_event_target_as = KMTtakepac_636_owner
					}
				}
				else = {
					636 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_636_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				635 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					635 = {
						owner = { is_puppet = no }
					}
				}
				635 = {
					owner = {
						save_event_target_as = KMTtakepac_635_owner
					}
				}
				else = {
					635 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_635_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				737 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					737 = {
						owner = { is_puppet = no }
					}
				}
				737 = {
					owner = {
						save_event_target_as = KMTtakepac_737_owner
					}
				}
				else = {
					737 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_737_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				634 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					634 = {
						owner = { is_puppet = no }
					}
				}
				634 = {
					owner = {
						save_event_target_as = KMTtakepac_634_owner
					}
				}
				else = {
					634 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_634_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				523 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					523 = {
						owner = { is_puppet = no }
					}
				}
				523 = {
					owner = {
						save_event_target_as = KMTtakepac_523_owner
					}
				}
				else = {
					523 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_523_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				517 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					517 = {
						owner = { is_puppet = no }
					}
				}
				517 = {
					owner = {
						save_event_target_as = KMTtakepac_517_owner
					}
				}
				else = {
					517 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_517_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				285 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					285 = {
						owner = { is_puppet = no }
					}
				}
				285 = {
					owner = {
						save_event_target_as = KMTtakepac_285_owner
					}
				}
				else = {
					285 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_285_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				521 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					521 = {
						owner = { is_puppet = no }
					}
				}
				521 = {
					owner = {
						save_event_target_as = KMTtakepac_521_owner
					}
				}
				else = {
					521 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_521_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				674 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					674 = {
						owner = { is_puppet = no }
					}
				}
				674 = {
					owner = {
						save_event_target_as = KMTtakepac_674_owner
					}
				}
				else = {
					674 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_674_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				519 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					519 = {
						owner = { is_puppet = no }
					}
				}
				519 = {
					owner = {
						save_event_target_as = KMTtakepac_519_owner
					}
				}
				else = {
					519 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_519_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				522 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					522 = {
						owner = { is_puppet = no }
					}
				}
				522 = {
					owner = {
						save_event_target_as = KMTtakepac_522_owner
					}
				}
				else = {
					522 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_522_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				520 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					520 = {
						owner = { is_puppet = no }
					}
				}
				520 = {
					owner = {
						save_event_target_as = KMTtakepac_520_owner
					}
				}
				else = {
					520 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_520_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				518 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					518 = {
						owner = { is_puppet = no }
					}
				}
				518 = {
					owner = {
						save_event_target_as = KMTtakepac_518_owner
					}
				}
				else = {
					518 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_518_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				284 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					284 = {
						owner = { is_puppet = no }
					}
				}
				284 = {
					owner = {
						save_event_target_as = KMTtakepac_284_owner
					}
				}
				else = {
					284 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_284_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				723 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					723 = {
						owner = { is_puppet = no }
					}
				}
				723 = {
					owner = {
						save_event_target_as = KMTtakepac_723_owner
					}
				}
				else = {
					723 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_723_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				669 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					669 = {
						owner = { is_puppet = no }
					}
				}
				669 = {
					owner = {
						save_event_target_as = KMTtakepac_669_owner
					}
				}
				else = {
					669 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakepac_669_owner
							}
						}
					}
				}
			}
		}
	}
}

KMT_take_SEA_wargoal = {
	custom_effect_tooltip = KMT_take_SEA_tt
	hidden_effect = {
		if = {
			limit = {
				524 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					524 = {
						owner = { is_puppet = no }
					}
				}
				524 = {
					owner = {
						save_event_target_as = KMTtakeSEA_524_owner
					}
				}
				else = {
					524 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_524_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				593 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					593 = {
						owner = { is_puppet = no }
					}
				}
				593 = {
					owner = {
						save_event_target_as = KMTtakeSEA_593_owner
					}
				}
				else = {
					593 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_593_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				592 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					592 = {
						owner = { is_puppet = no }
					}
				}
				592 = {
					owner = {
						save_event_target_as = KMTtakeSEA_592_owner
					}
				}
				else = {
					592 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_592_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				591 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					591 = {
						owner = { is_puppet = no }
					}
				}
				591 = {
					owner = {
						save_event_target_as = KMTtakeSEA_591_owner
					}
				}
				else = {
					591 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_591_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				594 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					594 = {
						owner = { is_puppet = no }
					}
				}
				594 = {
					owner = {
						save_event_target_as = KMTtakeSEA_594_owner
					}
				}
				else = {
					594 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_594_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				599 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					599 = {
						owner = { is_puppet = no }
					}
				}
				599 = {
					owner = {
						save_event_target_as = KMTtakeSEA_599_owner
					}
				}
				else = {
					599 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_599_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				671 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					671 = {
						owner = { is_puppet = no }
					}
				}
				671 = {
					owner = {
						save_event_target_as = KMTtakeSEA_671_owner
					}
				}
				else = {
					671 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_671_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				286 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					286 = {
						owner = { is_puppet = no }
					}
				}
				286 = {
					owner = {
						save_event_target_as = KMTtakeSEA_286_owner
					}
				}
				else = {
					286 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_286_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				286 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					286 = {
						owner = { is_puppet = no }
					}
				}
				286 = {
					owner = {
						save_event_target_as = KMTtakeSEA_286_owner
					}
				}
				else = {
					286 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_286_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				670 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					670 = {
						owner = { is_puppet = no }
					}
				}
				670 = {
					owner = {
						save_event_target_as = KMTtakeSEA_670_owner
					}
				}
				else = {
					670 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_670_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				741 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					741 = {
						owner = { is_puppet = no }
					}
				}
				741 = {
					owner = {
						save_event_target_as = KMTtakeSEA_741_owner
					}
				}
				else = {
					741 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_741_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				289 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					289 = {
						owner = { is_puppet = no }
					}
				}
				289 = {
					owner = {
						save_event_target_as = KMTtakeSEA_289_owner
					}
				}
				else = {
					289 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_289_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				724 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					724 = {
						owner = { is_puppet = no }
					}
				}
				724 = {
					owner = {
						save_event_target_as = KMTtakeSEA_724_owner
					}
				}
				else = {
					724 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_724_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				336 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					336 = {
						owner = { is_puppet = no }
					}
				}
				336 = {
					owner = {
						save_event_target_as = KMTtakeSEA_336_owner
					}
				}
				else = {
					336 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_336_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				672 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					672 = {
						owner = { is_puppet = no }
					}
				}
				672 = {
					owner = {
						save_event_target_as = KMTtakeSEA_672_owner
					}
				}
				else = {
					672 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_672_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				333 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					333 = {
						owner = { is_puppet = no }
					}
				}
				333 = {
					owner = {
						save_event_target_as = KMTtakeSEA_333_owner
					}
				}
				else = {
					333 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_333_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				334 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					334 = {
						owner = { is_puppet = no }
					}
				}
				334 = {
					owner = {
						save_event_target_as = KMTtakeSEA_334_owner
					}
				}
				else = {
					334 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_334_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				335 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					335 = {
						owner = { is_puppet = no }
					}
				}
				335 = {
					owner = {
						save_event_target_as = KMTtakeSEA_335_owner
					}
				}
				else = {
					335 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_335_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				626 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					626 = {
						owner = { is_puppet = no }
					}
				}
				626 = {
					owner = {
						save_event_target_as = KMTtakeSEA_626_owner
					}
				}
				else = {
					626 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_626_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				623 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					623 = {
						owner = { is_puppet = no }
					}
				}
				623 = {
					owner = {
						save_event_target_as = KMTtakeSEA_623_owner
					}
				}
				else = {
					623 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_623_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				327 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					327 = {
						owner = { is_puppet = no }
					}
				}
				327 = {
					owner = {
						save_event_target_as = KMTtakeSEA_327_owner
					}
				}
				else = {
					327 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_327_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				624 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					624 = {
						owner = { is_puppet = no }
					}
				}
				624 = {
					owner = {
						save_event_target_as = KMTtakeSEA_624_owner
					}
				}
				else = {
					624 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_624_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				628 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					628 = {
						owner = { is_puppet = no }
					}
				}
				628 = {
					owner = {
						save_event_target_as = KMTtakeSEA_628_owner
					}
				}
				else = {
					628 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_628_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				625 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					625 = {
						owner = { is_puppet = no }
					}
				}
				625 = {
					owner = {
						save_event_target_as = KMTtakeSEA_625_owner
					}
				}
				else = {
					625 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_625_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				627 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					627 = {
						owner = { is_puppet = no }
					}
				}
				627 = {
					owner = {
						save_event_target_as = KMTtakeSEA_627_owner
					}
				}
				else = {
					627 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_627_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				673 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					673 = {
						owner = { is_puppet = no }
					}
				}
				673 = {
					owner = {
						save_event_target_as = KMTtakeSEA_673_owner
					}
				}
				else = {
					673 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_673_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				668 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					668 = {
						owner = { is_puppet = no }
					}
				}
				668 = {
					owner = {
						save_event_target_as = KMTtakeSEA_668_owner
					}
				}
				else = {
					668 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_668_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				669 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					669 = {
						owner = { is_puppet = no }
					}
				}
				669 = {
					owner = {
						save_event_target_as = KMTtakeSEA_669_owner
					}
				}
				else = {
					669 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_669_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				667 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					667 = {
						owner = { is_puppet = no }
					}
				}
				667 = {
					owner = {
						save_event_target_as = KMTtakeSEA_667_owner
					}
				}
				else = {
					667 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_667_owner
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				721 = {
					owner = {
						NOT = { 
							tag = ROOT									
							is_puppet_of = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					721 = {
						owner = { is_puppet = no }
					}
				}
				721 = {
					owner = {
						save_event_target_as = KMTtakeSEA_721_owner
					}
				}
				else = {
					721 = {
						owner = { 
							overlord = { 
								save_event_target_as = KMTtakeSEA_721_owner
							}
						}
					}
				}
			}
		}
	}
}

get_usa_supplies = {
					if = {
						limit = {
							USA = {
								has_tech = infantry_weapons
								NOT = {
									has_tech = infantry_weapons1
								}
							}
						}
						add_equipment_to_stockpile = { type = infantry_equipment_0 amount = 10000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = infantry_weapons1
								NOT = {
									has_tech = improved_infantry_weapons
								}
							}
						}
						add_equipment_to_stockpile = { type = infantry_equipment_1 amount = 10000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = improved_infantry_weapons
								NOT = {
									has_tech = advanced_infantry_weapons
								}
							}
						}
						add_equipment_to_stockpile = { type = infantry_equipment_2 amount = 10000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = advanced_infantry_weapons
							}
						}
						add_equipment_to_stockpile = { type = infantry_equipment_3 amount = 10000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = tech_support
							}
						}
						add_equipment_to_stockpile = { type = support_equipment_1 amount = 7500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = gwtank
								NOT = {
									has_tech = basic_light_tank
								}
							}
						}
						add_equipment_to_stockpile = { type = gw_tank_equipment amount = 3500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = basic_light_tank
								NOT = {
									has_tech = improved_light_tank
								}
							}
						}
						add_equipment_to_stockpile = { type = light_tank_equipment_1 amount = 3500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = improved_light_tank
								NOT = {
									has_tech = advanced_light_tank
								}
							}
						}
						add_equipment_to_stockpile = { type = light_tank_equipment_2 amount = 3500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = improved_light_tank
							}
						}
						add_equipment_to_stockpile = { type = light_tank_equipment_3 amount = 3500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = basic_medium_tank
								NOT = {
									has_tech = improved_medium_tank
								}
							}
						}
						add_equipment_to_stockpile = { type = medium_tank_equipment_1 amount = 2000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = improved_medium_tank
								NOT = {
									has_tech = advanced_medium_tank
								}
							}
						}
						add_equipment_to_stockpile = { type = medium_tank_equipment_2 amount = 2000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = advanced_medium_tank
							}
						}
						add_equipment_to_stockpile = { type = medium_tank_equipment_3 amount = 2000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = basic_heavy_tank
								NOT = {
									has_tech = improved_heavy_tank
								}
							}
						}
						add_equipment_to_stockpile = { type = heavy_tank_equipment_1 amount = 500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = improved_heavy_tank
								NOT = {
									has_tech = advanced_heavy_tank
								}
							}
						}
						add_equipment_to_stockpile = { type = heavy_tank_equipment_2 amount = 500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = advanced_heavy_tank
							}
						}
						add_equipment_to_stockpile = { type = heavy_tank_equipment_3 amount = 500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = main_battle_tank
							}
						}
						add_equipment_to_stockpile = { type = modern_tank_equipment_1 amount = 100 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = super_heavy_tank
							}
						}
						add_equipment_to_stockpile = { type = super_heavy_tank_equipment_1 amount = 200 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = early_fighter
								NOT = {
									has_tech = fighter1
								}
							}
						}
						add_equipment_to_stockpile = { type = fighter_equipment_0 amount = 1000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = fighter1
								NOT = {
									has_tech = fighter2
								}
							}
						}
						add_equipment_to_stockpile = { type = fighter_equipment_1 amount = 1000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = fighter2
								NOT = {
									has_tech = fighter3
								}
							}
						}
						add_equipment_to_stockpile = { type = fighter_equipment_2 amount = 1000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = fighter3
							}
						}
						add_equipment_to_stockpile = { type = fighter_equipment_3 amount = 1000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = jet_fighter1
								NOT = {
									has_tech = jet_fighter2
								}
							}
						}
						add_equipment_to_stockpile = { type = jet_fighter_equipment_1 amount = 300 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = jet_fighter2
							}
						}
						add_equipment_to_stockpile = { type = jet_fighter_equipment_2 amount = 300 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = CAS1
								NOT = {
									has_tech = CAS2
								}
							}
						}
						add_equipment_to_stockpile = { type = CAS_equipment_1 amount = 1000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = CAS2
								NOT = {
									has_tech = CAS3
								}
							}
						}
						add_equipment_to_stockpile = { type = CAS_equipment_2 amount = 1000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = CAS3
							}
						}
						add_equipment_to_stockpile = { type = CAS_equipment_3 amount = 1000 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = naval_bomber1
								NOT = {
									has_tech = naval_bomber2
								}
							}
						}
						add_equipment_to_stockpile = { type = nav_bomber_equipment_1 amount = 100 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = naval_bomber2
								NOT = {
									has_tech = naval_bomber3
								}
							}
						}
						add_equipment_to_stockpile = { type = nav_bomber_equipment_2 amount = 100 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = naval_bomber3
							}
						}
						add_equipment_to_stockpile = { type = nav_bomber_equipment_3 amount = 100 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = naval_bomber1
								NOT = {
									has_tech = naval_bomber2
								}
							}
						}
						add_equipment_to_stockpile = { type = nav_bomber_equipment_1 amount = 100 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = naval_bomber2
								NOT = {
									has_tech = naval_bomber3
								}
							}
						}
						add_equipment_to_stockpile = { type = nav_bomber_equipment_2 amount = 100 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = naval_bomber3
							}
						}
						add_equipment_to_stockpile = { type = nav_bomber_equipment_3 amount = 100 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = heavy_fighter1
								NOT = {
									has_tech = heavy_fighter2
								}
							}
						}
						add_equipment_to_stockpile = { type = heavy_fighter_equipment_1 amount = 500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = heavy_fighter2
								NOT = {
									has_tech = heavy_fighter2
								}
							}
						}
						add_equipment_to_stockpile = { type = heavy_fighter_equipment_2 amount = 500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = heavy_fighter3
							}
						}
						add_equipment_to_stockpile = { type = heavy_fighter_equipment_3 amount = 500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = tactical_bomber1
								NOT = {
									has_tech = tactical_bomber2
								}
							}
						}
						add_equipment_to_stockpile = { type = tac_bomber_equipment_1 amount = 500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = tactical_bomber2
								NOT = {
									has_tech = tactical_bomber3
								}
							}
						}
						add_equipment_to_stockpile = { type = tac_bomber_equipment_2 amount = 500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = tactical_bomber3
							}
						}
						add_equipment_to_stockpile = { type = tac_bomber_equipment_3 amount = 500 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = jet_tactical_bomber1
								NOT = {
									has_tech = jet_tactical_bomber2
								}
							}
						}
						add_equipment_to_stockpile = { type = jet_tac_bomber_equipment_1 amount = 50 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = jet_tactical_bomber2
							}
						}
						add_equipment_to_stockpile = { type = jet_tac_bomber_equipment_2 amount = 50 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = strategic_bomber1
								NOT = {
									has_tech = strategic_bomber2
								}
							}
						}
						add_equipment_to_stockpile = { type = strat_bomber_equipment_1 amount = 100 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = strategic_bomber2
								NOT = {
									has_tech = strategic_bomber3
								}
							}
						}
						add_equipment_to_stockpile = { type = strat_bomber_equipment_1 amount = 100 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = strategic_bomber3
							}
						}
						add_equipment_to_stockpile = { type = strat_bomber_equipment_1 amount = 100 producer = USA }
					}
					if = {
						limit = {
							USA = {
								has_tech = jet_strategic_bomber1
							}
						}
						add_equipment_to_stockpile = { type = jet_strat_bomber_equipment_1 amount = 10 producer = USA }
					}
}


KMT_pro_jap_focus_civil_war = {
	if = {
		limit = {
			fascism < 0.2
		}
		start_civil_war = {
			ideology = neutrality
			capital = 814
			size = 0.8
			keep_unit_leaders_trigger = { has_unit_leader_flag = KMT_will_stay_after_pro_jap_coup }
			ruling_party = fascism
		}
		else = {
			if = {
				limit = {
					fascism < 0.3
				}
				start_civil_war = {
					ideology = neutrality
					capital = 814
					size = 0.75
					keep_unit_leaders_trigger = { has_unit_leader_flag = KMT_will_stay_after_pro_jap_coup }
					ruling_party = fascism
				}
				else = {
					if = {
						limit = {
							fascism < 0.4
						}
						start_civil_war = {
							ideology = neutrality
							capital = 814
							size = 0.7
							keep_unit_leaders_trigger = { has_unit_leader_flag = KMT_will_stay_after_pro_jap_coup }
							ruling_party = fascism
						}
						else = {
							if = {
								limit = {
									fascism < 0.5
								}
								start_civil_war = {
									ideology = neutrality
									capital = 814
									size = 0.65
									keep_unit_leaders_trigger = { has_unit_leader_flag = KMT_will_stay_after_pro_jap_coup }
									ruling_party = fascism
								}
								else = {
									if = {
										limit = {
											fascism < 0.6
										}
										start_civil_war = {
											ideology = neutrality
											capital = 814
											size = 0.6
											keep_unit_leaders_trigger = { has_unit_leader_flag = KMT_will_stay_after_pro_jap_coup }
											ruling_party = fascism
										}
										else = {
											if = {
												limit = {
													fascism < 0.7
												}
												start_civil_war = {
													ideology = neutrality
													capital = 814
													size = 0.55
													keep_unit_leaders_trigger = { has_unit_leader_flag = KMT_will_stay_after_pro_jap_coup }
													ruling_party = fascism
												}
												else = {
													start_civil_war = {
														ideology = neutrality
														capital = 814
														size = 0.5
														keep_unit_leaders_trigger = { has_unit_leader_flag = KMT_will_stay_after_pro_jap_coup }
														ruling_party = fascism
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

KMT_pro_jap_finish = {
	clr_global_flag = liangguang_incident
	clr_global_flag = cks_held
	set_country_flag = KMT_pro_japanese_coup
	hidden_effect = {
		if = {
			limit = {
				NOT = {
					has_country_flag = KMT_completed_pro_jap_focus
				}
			}
			unlock_national_focus = KMT_support_pro_japanese_faction
		}
	}
	every_country = {
		limit = {
			is_puppet_of = ROOT
		}
		ROOT = {
			end_puppet = PREV
		}
	}
	if = {
		limit = {
			has_idea = KMT_pro_jap_propaganda
		}
		remove_ideas = KMT_pro_jap_propaganda
	}
	if = {
		limit = {
			has_idea = KMT_pro_jap_propaganda_2
		}
		remove_ideas = KMT_pro_jap_propaganda_2
	}
	set_party_name = { ideology = fascism long_name = KMT_wjw name = KMT_wjw }
	create_country_leader = {
		name = "Wang Ching-wei"
		desc = "POLITICS_WANG_JINGWEI_DESC"
		picture = "gfx/leaders/kmt_mod/Portrait_Wang_Jingwei.dds"
		expire = "1965.1.1"
		ideology = fascism_ideology
		id = 1100
		traits = {
			#
		}
	}
	if = {
		limit = {
			has_country_leader = {
				name = "Chiang Kai-shek"
				ruling_only = yes
			}
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_country_flag = {
							flag = KMT_pro_jap_action_count
							value > 0
						}
						has_country_flag = {
							flag = KMT_pro_jap_action_count
							value < 3
						}
					}
					has_country_flag = KMT_xian_CHI_kill_chiang
				}
			}
			kill_country_leader = yes
			else = {
				hidden_effect = {
					retire_country_leader = yes
				}
			}
		}
	}
	if = {
		limit = { has_unit_leader = 1001 }
		remove_unit_leader = 1001
	}
	KMT_pro_jap_focus_civil_war = yes
	hidden_effect = {
		every_state = {
			limit = {
				is_core_of = ROOT
			}
			add_core_of = HYQ
		}
		random_country = {
			limit = {
				original_tag = event_target:KMT_central_gov_tag
				NOT = { tag = event_target:KMT_central_gov_tag }
				has_civil_war = yes
			}
			every_unit_leader = {	
				set_nationality = HYQ
			}
			every_state = {
				limit = {
					is_core_of = PREV
				}
				remove_core_of = PREV
			}
		} 
		every_owned_state = {
			limit = {
				is_capital = no
			}
			HYQ = {
				transfer_state = PREV
			}
		}
		HYQ = {
			country_event = { id = kmt.431 }
			declare_war_on = {
				target = ROOT
				type = civil_war
			}
		}
		transfer_state = 818
		if = {
			limit = {
				has_country_flag = {
					flag = KMT_pro_jap_action_count
					value > 0
				}
				598 = {
					owner = { tag = HYQ }
				}
			}
			transfer_state = 598
		}
		if = {
			limit = {
				has_country_flag = {
					flag = KMT_pro_jap_action_count
					value > 1
				}
			}
			if = {
				limit = {
					606 = {
						owner = { tag = HYQ }
					}
				}
				transfer_state = 606
			}
			if = {
				limit = {
					749 = {
						owner = { tag = HYQ }
					}
				}
				transfer_state = 749
			}
		}
		if = {
			limit = {
				has_country_flag = {
					flag = KMT_pro_jap_action_count
					value > 2
				}
				596 = {
					owner = { tag = HYQ }
				}
			}
			transfer_state = 596
		}
		every_unit_leader = {
			limit = {
				NOT = {
					has_unit_leader_flag = KMT_will_stay_after_pro_jap_coup
				}
			}
			set_nationality = HYQ
		}
	}
	custom_effect_tooltip = KMT_coup_new_line_tt
	HYQ = {
		set_capital = 613
		if = {
			limit = {
				event_target:KMT_central_gov_tag = { has_country_flag = KMT_pro_jap_bribe_officials }
			}
			add_stability = -0.1
			add_war_support = -0.05
		}
		if = {
			limit = {
				event_target:KMT_central_gov_tag = { has_country_flag = KMT_pro_jap_infiltrated_gov }
			}
			add_timed_idea = {
				idea = KMT_pro_jap_infiltrated_gov_idea
				days = 120
			}
		}
		if = {
			limit = {
				event_target:KMT_central_gov_tag = { has_country_flag = KMT_pro_jap_contacted_hyq }
			}
			add_timed_idea = {
				idea = KMT_pro_jap_contacted_hyq_idea
				days = 120
			}
		}
	}
	custom_effect_tooltip = KMT_coup_new_line_tt
	if = {
		limit = {
			has_country_flag = KMT_pro_jap_bribe_officials
		}
		set_stability = 0.45
		add_political_power = 75
		else = {
			set_stability = 0.4
		}
	}
	if = {
		limit = {
			has_country_flag = KMT_pro_jap_contacted_hyq
		}
		custom_effect_tooltip = KMT_pro_jap_contacted_hyq_more_troops_tt
		hidden_effect = {
			division_template = {
				name = "Ho Ying-chin Bu"	
				regiments = { 
					infantry = { x = 0 y = 0 } 
					infantry = { x = 0 y = 1 } 
					infantry = { x = 1 y = 0 } 
					infantry = { x = 1 y = 1 } 
				}
			}
			random_owned_controlled_state = {
				prioritize = { 613 }
				create_unit = { 
					division = "name = \"Ho Ying-chin Bu\" division_template = \"Ho Ying-chin Bu\" start_experience_factor = 0.25 start_equipment_factor = 0.9" 
					owner = event_target:KMT_central_gov_tag
				}
				create_unit = { 
					division = "name = \"Ho Ying-chin Bu\" division_template = \"Ho Ying-chin Bu\" start_experience_factor = 0.25 start_equipment_factor = 0.9" 
					owner = event_target:KMT_central_gov_tag
				}
			}
		}
	}
	set_war_support = 0.50
	
	custom_effect_tooltip = KMT_coup_new_line_tt
	if = {
		limit = {
			has_country_flag = {
				flag = KMT_pro_jap_action_count
				value < 1
			}
		}
		set_political_power = 50
		HYQ = {
			add_timed_idea = {
				idea = KMT_pro_jap_HYQ_penalty_unexpected
				days = 15
			}
		}
		else = {
			if = {
				limit = {
					has_country_flag = {
						flag = KMT_pro_jap_action_count
						value < 2
					}
				}
				set_political_power = 150
				HYQ = {
					add_timed_idea = {
						idea = KMT_pro_jap_HYQ_penalty_unexpected_2
						days = 45
					}
				}
				else = {
					if = {
						limit = {
							has_country_flag = {
								flag = KMT_pro_jap_action_count
								value < 3
							}
						}
						set_political_power = 250
						add_stability = -0.05
						else = {
							if = {
								limit = {
									has_country_flag = {
										flag = KMT_pro_jap_action_count
										value < 4
									}
								}
								set_political_power = 350
								add_timed_idea = {
									idea = KMT_pro_jap_ROOT_penalty
									days = 90
								}
								add_stability = -0.1
							}
						}
					}
				}
			}
		}
	}
	hidden_effect = {
		remove_opinion_modifier = {
			modifier = hostile_status
			target = JAP
		}
		JAP = {
			remove_opinion_modifier = {
				modifier = hostile_status
				target = ROOT
			}
		}
		set_politics = {
			ruling_party = fascism
		}
		set_popularities = {
			fascism = 95
			democratic = 2
			neutrality = 3
		}
		if = {
			limit = {
				PRC = { 
					exists = yes
					NOT = {
						OR = {
							has_war_together_with = event_target:KMT_central_gov_tag
							has_war_together_with = HYQ
							is_in_faction_with = event_target:KMT_central_gov_tag
							is_in_faction_with = HYQ
							has_war_with = event_target:KMT_central_gov_tag
							has_war_with = HYQ
						}
					}
				}
			}
			PRC = { country_event = { id = kmt.433 hours = 5 }}
		}
		if = {
			limit = {
				JAP = { 
					exists = yes
					NOT = {
						OR = {
							has_war_together_with = event_target:KMT_central_gov_tag
							has_war_together_with = HYQ
							is_in_faction_with = event_target:KMT_central_gov_tag
							is_in_faction_with = HYQ
							has_war_with = event_target:KMT_central_gov_tag
							has_war_with = HYQ
						}
					}
				}
			}
			JAP = { country_event = { id = kmt.433 hours = 5 }}
		}
		every_country = {
			limit = { 
				has_idea = cg_warlords 
				NOT = {
					OR = {
						has_war_together_with = event_target:KMT_central_gov_tag
						has_war_together_with = HYQ
						is_in_faction_with = event_target:KMT_central_gov_tag
						is_in_faction_with = HYQ
						has_war_with = event_target:KMT_central_gov_tag
						has_war_with = HYQ
					}
				}
				NOT = {
					is_puppet_of = JAP
					is_puppet_of = event_target:KMT_central_gov_tag
					is_puppet_of = HYQ
				}
			}
			country_event = { id = kmt.433 hours = 5 }
		}
		HYQ = {
			add_ideas = KMT_xian_firm_stance
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_country_flag = {
							flag = KMT_pro_jap_action_count
							value > 0
						}
						has_country_flag = {
							flag = KMT_pro_jap_action_count
							value < 3
						}
					}
					event_target:KMT_central_gov_tag = {
						has_country_flag = KMT_xian_CHI_kill_chiang
					}
				}
				HYQ = {
					has_country_leader = {
						name = "Chiang Kai-shek"
						ruling_only = yes
					}
				}
			}
			HYQ = {
				kill_country_leader = yes
				create_country_leader = {
					name = "Feng Yu-hsiang"
					picture = "gfx/leaders/kmt_mod/Portrait_Feng_Yuxiang.dds"
					desc = "POLITICS_FENG_YUXIANG_DESC"
					expire = "1965.1.1"
					ideology = oligarchism
					traits = {
						#
					}
				}
			}
		}
		if = {
			limit = {
				has_country_flag = KMT_pro_jap_local_militias
			}
			if = {
				limit = {
					has_country_flag = {
						flag = KMT_pro_jap_action_count
						value < 2
					}
				}
				load_oob = "CHI_support_pro_jap_1_action"
				else = {
					if = {
						limit = {
							has_country_flag = {
								flag = KMT_pro_jap_action_count
								value < 3
							}
						}
						load_oob = "CHI_support_pro_jap_2_action"
						if = {
							limit = {
								has_country_flag = {
									flag = KMT_pro_jap_action_count
									value < 4
								}
							}
							load_oob = "CHI_support_pro_jap_3_action"
						}
					}
				}
			}
		}
	}
}


KMT_red_coup_effect = {
	clr_global_flag = liangguang_incident
	clr_global_flag = cks_held
	set_country_flag = KMT_red_coup_finish
	hidden_effect = {
		every_country = {
			limit = {
				is_puppet_of = ROOT
			}
			ROOT = {
				end_puppet = PREV
			}
		}
	}
	if = {
		limit = {
			communism < 0.1
		}
		country_event = { id = kmt.481 }
		if = {
			limit = {
				has_government = neutrality
			}
			start_civil_war = {
				ideology = neutrality
				ruling_party = communism
				keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
				size = 0.9
			}
			else = {
				if = {
					limit = {
						has_government = democratic
					}
					start_civil_war = {
						ideology = democratic
						ruling_party = communism
						keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
						size = 0.9
					}
					else = {
						if = {
							limit = {
								has_government = fascism
							}
							start_civil_war = {
								ideology = fascism
								ruling_party = communism
								keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
								size = 0.9
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				has_global_flag = KMT_PRC_agrees_to_work_with_us
			}
			add_ideas = KMT_peasants_revolution_1
			else = {
				add_ideas = KMT_revolution_1
			}
		}
		else = {
			if = {
				limit = {
					communism < 0.2
				}
				random_list = {
					90 = {
						country_event = { id = kmt.480 }
						if = {
							limit = {
								has_government = neutrality
							}
							start_civil_war = {
								ideology = neutrality
								ruling_party = communism
								keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
								size = 0.75
							}
							else = {
								if = {
									limit = {
										has_government = democratic
									}
									start_civil_war = {
										ideology = democratic
										ruling_party = communism
										keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
										size = 0.75
									}
									else = {
										if = {
											limit = {
												has_government = fascism
											}
											start_civil_war = {
												ideology = fascism
												ruling_party = communism
												keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
												size = 0.75
											}
										}
									}
								}
							}
						}
						if = {
							limit = {
								has_global_flag = KMT_PRC_agrees_to_work_with_us
							}
							add_ideas = KMT_peasants_revolution_2
							else = {
								add_ideas = KMT_revolution_2
							}
						}
						custom_effect_tooltip = KMT_coup_new_line_tt
					}
					10 = {
						country_event = { id = kmt.481 }
						set_politics = {
							ruling_party = communism
						}
						add_timed_idea = {
							idea = KMT_triumphant_revolution
							days = 720
						}
						custom_effect_tooltip = KMT_coup_new_line_tt
					}
				}
				else = {
					if = {
						limit = {
							communism < 0.3
						}
						random_list = {
							80 = {
								country_event = { id = kmt.480 }
								if = {
									limit = {
										has_government = neutrality
									}
									start_civil_war = {
										ideology = neutrality
										ruling_party = communism
										keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
										size = 0.65
									}
									else = {
										if = {
											limit = {
												has_government = democratic
											}
											start_civil_war = {
												ideology = democratic
												ruling_party = communism
												keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
												size = 0.65
											}
											else = {
												if = {
													limit = {
														has_government = fascism
													}
													start_civil_war = {
														ideology = fascism
														ruling_party = communism
														keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
														size = 0.65
													}
												}
											}
										}
									}
								}
								if = {
									limit = {
										has_global_flag = KMT_PRC_agrees_to_work_with_us
									}
									add_ideas = KMT_peasants_revolution_3
									else = {
										add_ideas = KMT_revolution_3
									}
								}
								custom_effect_tooltip = KMT_coup_new_line_tt
							}
							20 = {
								country_event = { id = kmt.481 }
								set_politics = {
									ruling_party = communism
								}
								add_timed_idea = {
									idea = KMT_triumphant_revolution
									days = 720
								}
								custom_effect_tooltip = KMT_coup_new_line_tt
							}
						}
						else = {
							if = {
								limit = {
									communism < 0.4
								}
								random_list = {
									70 = {
										country_event = { id = kmt.480 }
										if = {
											limit = {
												has_government = neutrality
											}
											start_civil_war = {
												ideology = neutrality
												ruling_party = communism
												keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
												size = 0.55
											}
											else = {
												if = {
													limit = {
														has_government = democratic
													}
													start_civil_war = {
														ideology = democratic
														ruling_party = communism
														keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
														size = 0.55
													}
													else = {
														if = {
															limit = {
																has_government = fascism
															}
															start_civil_war = {
																ideology = fascism
																ruling_party = communism
																keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																size = 0.55
															}
														}
													}
												}
											}
										}
										if = {
											limit = {
												has_global_flag = KMT_PRC_agrees_to_work_with_us
											}
											add_ideas = KMT_peasants_revolution_4
											else = {
												add_ideas = KMT_revolution_4
											}
										}
										custom_effect_tooltip = KMT_coup_new_line_tt
									}
									30 = {
										country_event = { id = kmt.481 }
										set_politics = {
											ruling_party = communism
										}
										add_timed_idea = {
											idea = KMT_triumphant_revolution
											days = 720
										}
										custom_effect_tooltip = KMT_coup_new_line_tt
									}
								}
								else = {
									if = {
										limit = {
											communism < 0.5
										}
										random_list = {
											60 = {
												country_event = { id = kmt.480 }
												if = {
													limit = {
														has_government = neutrality
													}
													start_civil_war = {
														ideology = neutrality
														ruling_party = communism
														keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
														size = 0.45
													}
													else = {
														if = {
															limit = {
																has_government = democratic
															}
															start_civil_war = {
																ideology = democratic
																ruling_party = communism
																keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																size = 0.45
															}
															else = {
																if = {
																	limit = {
																		has_government = fascism
																	}
																	start_civil_war = {
																		ideology = fascism
																		ruling_party = communism
																		keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																		size = 0.45
																	}
																}
															}
														}
													}
												}
												if = {
													limit = {
														has_global_flag = KMT_PRC_agrees_to_work_with_us
													}
													add_ideas = KMT_peasants_revolution_5
													else = {
														add_ideas = KMT_revolution_5
													}
												}
												custom_effect_tooltip = KMT_coup_new_line_tt
											}
											40 = {
												country_event = { id = kmt.481 }
												set_politics = {
													ruling_party = communism
												}
												add_timed_idea = {
													idea = KMT_triumphant_revolution
													days = 720
												}
												custom_effect_tooltip = KMT_coup_new_line_tt
											}
										}
										else = {
											if = {
												limit = {
													communism < 0.6
												}
												random_list = {
													50 = {
														country_event = { id = kmt.480 }
														if = {
															limit = {
																has_government = neutrality
															}
															start_civil_war = {
																ideology = neutrality
																ruling_party = communism
																keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																size = 0.35
															}
															else = {
																if = {
																	limit = {
																		has_government = democratic
																	}
																	start_civil_war = {
																		ideology = democratic
																		ruling_party = communism
																		keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																		size = 0.35
																	}
																	else = {
																		if = {
																			limit = {
																				has_government = fascism
																			}
																			start_civil_war = {
																				ideology = fascism
																				ruling_party = communism
																				keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																				size = 0.35
																			}
																		}
																	}
																}
															}
														}
														if = {
															limit = {
																has_global_flag = KMT_PRC_agrees_to_work_with_us
															}
															add_ideas = KMT_peasants_revolution_6
															else = {
																add_ideas = KMT_revolution_6
															}
														}
														custom_effect_tooltip = KMT_coup_new_line_tt
													}
													50 = {
														country_event = { id = kmt.481 }
														set_politics = {
															ruling_party = communism
														}
														add_timed_idea = {
															idea = KMT_triumphant_revolution
															days = 720
														}
														custom_effect_tooltip = KMT_coup_new_line_tt
													}
												}
												else = {
													if = {
														limit = {
															communism < 0.7
														}
														random_list = {
															35 = {
																country_event = { id = kmt.480 }
																if = {
																	limit = {
																		has_government = neutrality
																	}
																	start_civil_war = {
																		ideology = neutrality
																		ruling_party = communism
																		keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																		size = 0.25
																	}
																	else = {
																		if = {
																			limit = {
																				has_government = democratic
																			}
																			start_civil_war = {
																				ideology = democratic
																				ruling_party = communism
																				keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																				size = 0.25
																			}
																			else = {
																				if = {
																					limit = {
																						has_government = fascism
																					}
																					start_civil_war = {
																						ideology = fascism
																						ruling_party = communism
																						keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																						size = 0.25
																					}
																				}
																			}
																		}
																	}
																}
																if = {
																	limit = {
																		has_global_flag = KMT_PRC_agrees_to_work_with_us
																	}
																	add_ideas = KMT_peasants_revolution_7
																	else = {
																		add_ideas = KMT_revolution_7
																	}
																}
																custom_effect_tooltip = KMT_coup_new_line_tt
															}
															65 = {
																country_event = { id = kmt.481 }
																set_politics = {
																	ruling_party = communism
																}
																add_timed_idea = {
																	idea = KMT_triumphant_revolution
																	days = 720
																}
																custom_effect_tooltip = KMT_coup_new_line_tt
															}
														}
														else = {
															if = {
																limit = {
																	communism < 0.8
																}
																random_list = {
																	20 = {
																		country_event = { id = kmt.480 }
																		if = {
																			limit = {
																				has_government = neutrality
																			}
																			start_civil_war = {
																				ideology = neutrality
																				ruling_party = communism
																				keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																				size = 0.25
																			}
																			else = {
																				if = {
																					limit = {
																						has_government = democratic
																					}
																					start_civil_war = {
																						ideology = democratic
																						ruling_party = communism
																						keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																						size = 0.25
																					}
																					else = {
																						if = {
																							limit = {
																								has_government = fascism
																							}
																							start_civil_war = {
																								ideology = fascism
																								ruling_party = communism
																								keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																								size = 0.25
																							}
																						}
																					}
																				}
																			}
																		}
																		if = {
																			limit = {
																				has_global_flag = KMT_PRC_agrees_to_work_with_us
																			}
																			add_ideas = KMT_peasants_revolution_7
																			else = {
																				add_ideas = KMT_revolution_7
																			}
																		}
																		custom_effect_tooltip = KMT_coup_new_line_tt
																	}
																	80 = {
																		country_event = { id = kmt.481 }
																		set_politics = {
																			ruling_party = communism
																		}
																		add_timed_idea = {
																			idea = KMT_triumphant_revolution
																			days = 720
																		}
																		custom_effect_tooltip = KMT_coup_new_line_tt
																	}
																}
																else = {
																	if = {
																		limit = {
																			communism < 0.9
																		}
																		random_list = {
																			10 = {
																				country_event = { id = kmt.480 }
																				if = {
																					limit = {
																						has_government = neutrality
																					}
																					start_civil_war = {
																						ideology = neutrality
																						ruling_party = communism
																						keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																						size = 0.25
																					}
																					else = {
																						if = {
																							limit = {
																								has_government = democratic
																							}
																							start_civil_war = {
																								ideology = democratic
																								ruling_party = communism
																								keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																								size = 0.25
																							}
																							else = {
																								if = {
																									limit = {
																										has_government = fascism
																									}
																									start_civil_war = {
																										ideology = fascism
																										ruling_party = communism
																										keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
																										size = 0.25
																									}
																								}
																							}
																						}
																					}
																				}
																				if = {
																					limit = {
																						has_global_flag = KMT_PRC_agrees_to_work_with_us
																					}
																					add_ideas = KMT_peasants_revolution_7
																					else = {
																						add_ideas = KMT_revolution_7
																					}
																				}
																				custom_effect_tooltip = KMT_coup_new_line_tt
																			}
																			90 = {
																				country_event = { id = kmt.481 }
																				set_politics = {
																					ruling_party = communism
																				}
																				add_timed_idea = {
																					idea = KMT_triumphant_revolution
																					days = 720
																				}
																				custom_effect_tooltip = KMT_coup_new_line_tt
																			}
																		}
																		else = {
																			country_event = { id = kmt.481 }
																			set_politics = {
																				ruling_party = communism
																			}
																			add_timed_idea = {
																				idea = KMT_triumphant_revolution
																				days = 720
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	add_popularity = {
		ideology = communism
		popularity = 0.95
	}
	if = {
		limit = {
			has_global_flag = KMT_coup_more_pp
		}
		add_political_power = 200
	}
	if = {
		limit = {
			has_global_flag = KMT_coup_chen_duxiu_leader
		}
		set_party_name = { ideology = communism long_name = KMT_new_cpc name = KMT_new_cpc_short }
		create_country_leader = {
			name = "Ch'en Tu-hsiu"
			desc = "POLITICS_CHEN_DUXIU_DESC"
			picture = "gfx/leaders/kmt_mod/Portrait_Chen_Duxiu.dds"
			expire = "1965.1.1"
			ideology = leninism
			traits = {
				PRC_trotskyist
			}
		}
	}
	if = {
		limit = {
			has_global_flag = KMT_coup_get_reinforcements
		}
		division_template = {
			name = "Zhong Gong Yuan Jun"
			regiments = {
				infantry = { x = 0 y = 0 }
				infantry = { x = 0 y = 1 } 
				infantry = { x = 1 y = 0 }
				infantry = { x = 1 y = 1 } 
			}
		}
		random_owned_controlled_state = {
			prioritize = { 613 }
			create_unit = { 
				division = "name = \"Zhong Gong Yuan Jun\" division_template = \"Zhong Gong Yuan Jun\" start_experience_factor = 0.3" 
				owner = event_target:KMT_central_gov_tag
			}
			create_unit = { 
				division = "name = \"Zhong Gong Yuan Jun\" division_template = \"Zhong Gong Yuan Jun\" start_experience_factor = 0.3" 
				owner = event_target:KMT_central_gov_tag
			}
		}
	}
	hidden_effect = {
		if = {
			limit = {
				has_idea = KMT_government_reforming
			}
			remove_ideas = KMT_government_reforming
		}
		if = { limit = { has_unit_leader = 1001 } remove_unit_leader = 1001 }
		if = { limit = { has_unit_leader = 10011 } remove_unit_leader = 10011 }
		every_state = {
			limit = {
				is_core_of = event_target:KMT_central_gov_tag
			}
			add_core_of = HYQ
		}
		if = {
			limit = {
				has_civil_war = yes
			}
			random_country = {
				limit = {
					original_tag = event_target:KMT_central_gov_tag
					NOT = { tag = event_target:KMT_central_gov_tag }
				}
				every_unit_leader = {
					set_nationality = HYQ
				}
				every_state = {
					limit = {
						is_core_of = PREV
					}
					remove_core_of = PREV
				}
				HYQ = {
					annex_country = {
						target = PREV
						transfer_troops = yes
					}
					declare_war_on = {
						target = ROOT
						type = civil_war
					}
					set_politics = {
						ruling_party = neutrality
						elections_allowed = no
					}
					set_popularities = {
						democratic = 5
						fascism = 5
						communism = 1
						neutrality =  89
					}
					if = {
						limit = {
							NOT = {
								has_global_flag = cks_killed_xian
							}
						}			
						create_country_leader = {
							name = "Chiang Kai-shek"
							picture = "gfx/leaders/event_target:KMT_central_gov_tag/Portrait_China_Chiang_Kai_Shek.dds"
							desc = "POLITICS_CHIANG_KAI-SHEK_DESC_DESC"
							expire = "1965.1.1"
							ideology = despotism
							traits = {
								KMT_cks_generallissimo
							}
						}
						else = {	
							create_country_leader = {
								name = "Feng Yu-hsiang"
								picture = "gfx/leaders/kmt_mod/Portrait_Feng_Yuxiang.dds"
								desc = "POLITICS_FENG_YUXIANG_DESC"
								expire = "1965.1.1"
								ideology = oligarchism
								traits = {
									#
								}
							}
						}
					}
				}
			}
			if = {
				limit = {
					PRC = { 
						exists = yes
						NOT = {
							OR = {
								has_war_together_with = event_target:KMT_central_gov_tag
								has_war_together_with = HYQ
								is_in_faction_with = event_target:KMT_central_gov_tag
								is_in_faction_with = HYQ
								has_war_with = event_target:KMT_central_gov_tag
								has_war_with = HYQ
							}
						}
					}
				}
				PRC = { country_event = { id = kmt.482 hours = 2 }}
			}
			if = {
				limit = {
					JAP = { 
						exists = yes
						NOT = {
							OR = {
								has_war_together_with = event_target:KMT_central_gov_tag
								has_war_together_with = HYQ
								is_in_faction_with = event_target:KMT_central_gov_tag
								is_in_faction_with = HYQ
								has_war_with = event_target:KMT_central_gov_tag
								has_war_with = HYQ
							}
						}
					}
				}
				JAP = { country_event = { id = kmt.482 hours = 5 }}
			}
			every_country = {
				limit = { 
					has_idea = cg_warlords 
					NOT = {
						OR = {
							has_war_together_with = event_target:KMT_central_gov_tag
							has_war_together_with = HYQ
							is_in_faction_with = event_target:KMT_central_gov_tag
							is_in_faction_with = HYQ
							has_war_with = event_target:KMT_central_gov_tag
							has_war_with = HYQ
						}
					}
					NOT = {
						is_puppet_of = JAP
						is_puppet_of = event_target:KMT_central_gov_tag
						is_puppet_of = HYQ
					}
				}
				country_event = { id = kmt.482 hours = 5 }
			}
			every_unit_leader = {
				limit = {
					OR = {
						has_id = 1001
						has_id = 1003
						has_id = 1005
						has_id = 1016
						has_id = 1019
						has_id = 1022
					}
				}
				set_nationality = HYQ
			}
		}
	}
}

KMT_red_coup_effect_procrastinated = {
	set_country_flag = KMT_red_coup_finish
	hidden_effect = {
		every_country = {
			limit = {
				is_puppet_of = ROOT
			}
			ROOT = {
				end_puppet = PREV
			}
		}
	}
	if = {
		limit = {
			communism < 0.1
		}
		if = {
			limit = {
				has_government = neutrality
			}
			start_civil_war = {
				ideology = neutrality
				ruling_party = communism
				keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
				size = 0.9
			}
			else = {
				if = {
					limit = {
						has_government = democratic
					}
					start_civil_war = {
						ideology = democratic
						ruling_party = communism
						keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
						size = 0.9
					}
					else = {
						if = {
							limit = {
								has_government = fascism
							}
							start_civil_war = {
								ideology = fascism
								ruling_party = communism
								keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
								size = 0.9
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				has_global_flag = KMT_PRC_agrees_to_work_with_us
			}
			add_ideas = KMT_peasants_revolution_1
			else = {
				add_ideas = KMT_revolution_1
			}
		}
		else = {
			if = {
				limit = {
					communism < 0.2
				}
				if = {
					limit = {
						has_government = neutrality
					}
					start_civil_war = {
						ideology = neutrality
						ruling_party = communism
						keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
						size = 0.7
					}
					else = {
						if = {
							limit = {
								has_government = democratic
							}
							start_civil_war = {
								ideology = democratic
								ruling_party = communism
								keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
								size = 0.7
							}
							else = {
								if = {
									limit = {
										has_government = fascism
									}
									start_civil_war = {
										ideology = fascism
										ruling_party = communism
										keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
										size = 0.7
									}
								}
							}
						}
					}
				}
				if = {
					limit = {
						has_global_flag = KMT_PRC_agrees_to_work_with_us
					}
					add_ideas = KMT_peasants_revolution_2
					else = {
						add_ideas = KMT_revolution_2
					}
				}
				else = {
					if = {
						limit = {
							communism < 0.3
						}
						if = {
							limit = {
								has_government = neutrality
							}
							start_civil_war = {
								ideology = neutrality
								ruling_party = communism
								keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
								size = 0.6
							}
							else = {
								if = {
									limit = {
										has_government = democratic
									}
									start_civil_war = {
										ideology = democratic
										ruling_party = communism
										keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
										size = 0.6
									}
									else = {
										if = {
											limit = {
												has_government = fascism
											}
											start_civil_war = {
												ideology = fascism
												ruling_party = communism
												keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
												size = 0.6
											}
										}
									}
								}
							}
						}
						if = {
							limit = {
								has_global_flag = KMT_PRC_agrees_to_work_with_us
							}
							add_ideas = KMT_peasants_revolution_3
							else = {
								add_ideas = KMT_revolution_3
							}
						}
						else = {
							if = {
								limit = {
									communism < 0.4
								}
								if = {
									limit = {
										has_government = neutrality
									}
									start_civil_war = {
										ideology = neutrality
										ruling_party = communism
										keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
										size = 0.5
									}
									else = {
										if = {
											limit = {
												has_government = democratic
											}
											start_civil_war = {
												ideology = democratic
												ruling_party = communism
												keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
												size = 0.5
											}
											else = {
												if = {
													limit = {
														has_government = fascism
													}
													start_civil_war = {
														ideology = fascism
														ruling_party = communism
														keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
														size = 0.5
													}
												}
											}
										}
									}
								}
								if = {
									limit = {
										has_global_flag = KMT_PRC_agrees_to_work_with_us
									}
									add_ideas = KMT_peasants_revolution_4
									else = {
										add_ideas = KMT_revolution_4
									}
								}
								else = {
									if = {
										limit = {
											has_government = neutrality
										}
										start_civil_war = {
											ideology = neutrality
											ruling_party = communism
											keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
											size = 0.4
										}
										else = {
											if = {
												limit = {
													has_government = democratic
												}
												start_civil_war = {
													ideology = democratic
													ruling_party = communism
													keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
													size = 0.4
												}
												else = {
													if = {
														limit = {
															has_government = fascism
														}
														start_civil_war = {
															ideology = fascism
															ruling_party = communism
															keep_unit_leaders = { 1033 1034 1035 1036 1037 1038 1039 }
															size = 0.4
														}
													}
												}
											}
										}
									}
									if = {
										limit = {
											has_global_flag = KMT_PRC_agrees_to_work_with_us
										}
										add_ideas = KMT_peasants_revolution_5
										else = {
											add_ideas = KMT_revolution_5
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	if = {
		limit = {
			has_global_flag = KMT_coup_more_pp
		}
		add_political_power = 100
	}
	if = {
		limit = {
			has_global_flag = KMT_coup_chen_duxiu_leader
		}
		set_party_name = { ideology = communism long_name = KMT_new_cpc name = KMT_new_cpc_short }
		create_country_leader = {
			name = "Ch'en Tu-hsiu"
			desc = "POLITICS_CHEN_DUXIU_DESC"
			picture = "gfx/leaders/kmt_mod/Portrait_Chen_Duxiu.dds"
			expire = "1965.1.1"
			ideology = leninism
			traits = {
				PRC_trotskyist
			}
		}
	}
	if = {
		limit = {
			has_global_flag = KMT_coup_get_reinforcements
		}
		division_template = {
			name = "Zhong Gong Yuan Jun"
			regiments = {
				infantry = { x = 0 y = 0 }
				infantry = { x = 0 y = 1 } 
				infantry = { x = 1 y = 0 }
				infantry = { x = 1 y = 1 } 
			}
		}
		random_owned_controlled_state = {
			prioritize = { 613 }
			create_unit = { 
				division = "name = \"Zhong Gong Yuan Jun\" division_template = \"Zhong Gong Yuan Jun\" start_experience_factor = 0.3" 
				owner = event_target:KMT_central_gov_tag
			}
			create_unit = { 
				division = "name = \"Zhong Gong Yuan Jun\" division_template = \"Zhong Gong Yuan Jun\" start_experience_factor = 0.3" 
				owner = event_target:KMT_central_gov_tag
			}
		}
	}
	hidden_effect = {
		if = {
			limit = {
				has_idea = KMT_government_reforming
			}
			remove_ideas = KMT_government_reforming
		}
		if = { limit = { has_unit_leader = 1001 } remove_unit_leader = 1001 }
		if = { limit = { has_unit_leader = 10011 } remove_unit_leader = 10011 }
		every_state = {
			limit = {
				is_core_of = event_target:KMT_central_gov_tag
			}
			add_core_of = HYQ
		}
		if = {
			limit = {
				has_civil_war = yes
			}
			random_country = {
				limit = {
					original_tag = event_target:KMT_central_gov_tag
					NOT = { tag = event_target:KMT_central_gov_tag }
				}
				every_state = {
					limit = {
						is_core_of = PREV
					}
					remove_core_of = PREV
				}
				every_unit_leader = {
					set_nationality = HYQ
				}
				HYQ = {
					annex_country = {
						target = PREV
						transfer_troops = yes
					}
					declare_war_on = {
						target = ROOT
						type = civil_war
					}
					set_politics = {
						ruling_party = neutrality
						elections_allowed = no
					}
					set_popularities = {
						democratic =  5
						fascism = 5
						communism = 1
						neutrality = 89
					}
					if = {
						limit = {
							NOT = {
								has_global_flag = cks_killed_xian
							}
						}			
						create_country_leader = {
							name = "Chiang Kai-shek"
							picture = "gfx/leaders/event_target:KMT_central_gov_tag/Portrait_China_Chiang_Kai_Shek.dds"
							desc = "POLITICS_CHIANG_KAI-SHEK_DESC_DESC"
							expire = "1965.1.1"
							ideology = despotism
							traits = {
								KMT_cks_generallissimo
							}
						}
						else = {	
							create_country_leader = {
								name = "Feng Yu-hsiang"
								picture = "gfx/leaders/kmt_mod/Portrait_Feng_Yuxiang.dds"
								desc = "POLITICS_FENG_YUXIANG_DESC"
								expire = "1965.1.1"
								ideology = oligarchism
								traits = {
									#
								}
							}
						}
					}
				}
			}
			if = {
				limit = {
					PRC = { 
						exists = yes
						NOT = {
							OR = {
								has_war_together_with = event_target:KMT_central_gov_tag
								has_war_together_with = HYQ
								is_in_faction_with = event_target:KMT_central_gov_tag
								is_in_faction_with = HYQ
								has_war_with = event_target:KMT_central_gov_tag
								has_war_with = HYQ
							}
						}
					}
				}
				PRC = { country_event = { id = kmt.482 hours = 2 }}
			}
			if = {
				limit = {
					JAP = { 
						exists = yes
						NOT = {
							OR = {
								has_war_together_with = event_target:KMT_central_gov_tag
								has_war_together_with = HYQ
								is_in_faction_with = event_target:KMT_central_gov_tag
								is_in_faction_with = HYQ
								has_war_with = event_target:KMT_central_gov_tag
								has_war_with = HYQ
							}
						}
					}
				}
				JAP = { country_event = { id = kmt.482 hours = 5 }}
			}
			every_country = {
				limit = { 
					OR = {
						has_idea = cg_warlords 
						has_idea = cg_warlords 
						tag = PGR
						tag = ZXL
						tag = MEN
					}
					NOT = {
						OR = {
							has_war_together_with = event_target:KMT_central_gov_tag
							has_war_together_with = HYQ
							is_in_faction_with = event_target:KMT_central_gov_tag
							is_in_faction_with = HYQ
							has_war_with = event_target:KMT_central_gov_tag
							has_war_with = HYQ
						}
					}
					NOT = {
						is_puppet_of = JAP
						is_puppet_of = event_target:KMT_central_gov_tag
						is_puppet_of = HYQ
					}
				}
				country_event = { id = kmt.482 hours = 5 }
			}
			random_unit_leader = {
				limit = {
					OR = {
						has_id = 1001
						has_id = 1003
						has_id = 1005
						has_id = 1016
						has_id = 1019
						has_id = 1022
					}
				}
				set_nationality = HYQ
			}
			random_country = {
				limit = {
					original_tag = event_target:KMT_central_gov_tag
					NOT = { tag = event_target:KMT_central_gov_tag }
				}
				every_unit_leader = {
					set_nationality = HYQ
				}
			}
		}
	}
}

oust_the_coloniser_effect = {
	every_country = {
		limit = {
			any_owned_state = {
				is_on_continent = asia
			}
			capital_scope = {
				NOT = {
					is_on_continent = asia
				}
			}
			NOT = {
				tag = SOV
				has_war_with = ROOT
			}
		}
		ROOT = {
			create_wargoal = {
				target = PREV
				type = topple_government
			}
		}
	}
	every_country = {
		limit = {
			capital_scope = {
				is_on_continent = asia
			}
			is_puppet = yes
			overlord = {
				capital_scope = {
					NOT = {
						is_on_continent = asia
					}
				}
			}
		}
		overlord = {
			ROOT = {
				create_wargoal = {
					target = PREV
					type = topple_government
				}
			}
		}
	}
}

KMT_own_fighter_assembly = {
	if = {
		limit = {
			has_completed_focus = KMT_setup_camco_assembly_plants
			OR = {
				burma_road_ok = yes
				yunnan_bahn_ok = yes
			}
		}
		
	}
}

foreign_supply_effect = {
	if = {
		limit = {
			ENG = {
				is_puppet = no
				has_capitulated = no
			}
			has_global_flag = KMT_ENG_agreed_to_assist
		}
		if = {
			limit = {
				ENG = {
					has_tech = advanced_infantry_weapons
					has_opinion = {
						target = ROOT
						value > 84
					}
				}
			}
			add_equipment_to_stockpile = { type = infantry_equipment_3 amount = 200 producer = ENG }
			else = {
				if = {
					limit = {
						ENG = {
							has_tech = improved_infantry_weapons
							has_opinion = {
								target = ROOT
								value > 64
							}
						}
					}
					add_equipment_to_stockpile = { type = infantry_equipment_2 amount = 200 producer = ENG }
					else = {
						if = {
							limit = {
								ENG = {
									has_opinion = {
										target = ROOT
										value > 44
									}
								}
							}
							add_equipment_to_stockpile = { type = infantry_equipment_1 amount = 200 producer = ENG }
							else = {
								add_equipment_to_stockpile = { type = infantry_equipment_0 amount = 200 producer = ENG }
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				USA = {
					has_tech = tech_support
					has_opinion = {
						target = ROOT
						value > 14
					}
				}
			}
			add_equipment_to_stockpile = { type = support_equipment_1 amount = 100 producer = ENG }
		}
		if = {
			limit = {
				ENG = {
					has_tech = fighter3
					has_opinion = {
						target = ROOT
						value > 84
					}
				}
			}
			add_equipment_to_stockpile = { type = fighter_equipment_3 amount = 8 producer = ENG }
			else = {
				if = {
					limit = {
						ENG = {
							has_tech = fighter2
							has_opinion = {
								target = ROOT
								value > 64
							}
						}
					}
					add_equipment_to_stockpile = { type = fighter_equipment_2 amount = 8 producer = ENG }
					else = {
						if = {
							limit = {
								ENG = {
									has_tech = fighter1
									has_opinion = {
										target = ROOT
										value > 44
									}
								}
							}
							add_equipment_to_stockpile = { type = fighter_equipment_1 amount = 8 producer = ENG }
							else = {
								if = {
									limit = {
										ENG = {
											has_tech = early_fighter
											has_opinion = {
												target = ROOT
												value > 24
											}
										}
									}
									add_equipment_to_stockpile = { type = fighter_equipment_0 amount = 8 producer = ENG }
								}
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				ENG = {
					has_tech = advanced_light_tank
					has_opinion = {
						target = ROOT
						value > 94
					}
				}
			}
			add_equipment_to_stockpile = { type = light_tank_equipment_3 amount = 8 producer = ENG }
			else = {
				if = {
					limit = {
						ENG = {
							has_tech = improved_light_tank
							has_opinion = {
								target = ROOT
								value > 84
							}
						}
					}
					add_equipment_to_stockpile = { type = light_tank_equipment_2 amount = 8 producer = ENG }
					else = {
						if = {
							limit = {
								ENG = {
									has_tech = basic_light_tank
									has_opinion = {
										target = ROOT
										value > 74
									}
								}
							}
							add_equipment_to_stockpile = { type = light_tank_equipment_1 amount = 8 producer = ENG }
							else = {
								if = {
									limit = {
										ENG = {
											has_tech = gwtank
											has_opinion = {
												target = ROOT
												value > 64
											}
										}
									}
									add_equipment_to_stockpile = { type = gw_tank_equipment amount = 8 producer = ENG }
								}
							}
						}
					}
				}
			}
		}
	}
	if = {
		limit = {
			USA = {
				is_puppet = no
				has_capitulated = no
			}
			has_global_flag = KMT_USA_agreed_to_assist
		}
		if = {
			limit = {
				USA = {
					has_tech = advanced_infantry_weapons
					has_opinion = {
						target = ROOT
						value > 84
					}
				}
			}
			add_equipment_to_stockpile = { type = infantry_equipment_3 amount = 200 producer = USA }
			else = {
				if = {
					limit = {
						USA = {
							has_tech = improved_infantry_weapons
							has_opinion = {
								target = ROOT
								value > 64
							}
						}
					}
					add_equipment_to_stockpile = { type = infantry_equipment_2 amount = 200 producer = USA }
					else = {
						if = {
							limit = {
								USA = {
									has_tech = infantry_weapons1
									has_opinion = {
										target = ROOT
										value > 64
									}
								}
							}
							add_equipment_to_stockpile = { type = infantry_equipment_1 amount = 200 producer = USA }
							else = {
								add_equipment_to_stockpile = { type = infantry_equipment_0 amount = 200 producer = USA }
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				USA = {
					has_tech = tech_support
					has_opinion = {
						target = ROOT
						value > 14
					}
				}
			}
			add_equipment_to_stockpile = { type = support_equipment_1 amount = 100 producer = USA }
		}
		if = {
			limit = {
				USA = {
					has_tech = fighter3
					has_opinion = {
						target = ROOT
						value > 84
					}
				}
			}
			add_equipment_to_stockpile = { type = fighter_equipment_3 amount = 8 producer = USA }
			else = {
				if = {
					limit = {
						USA = {
							has_tech = fighter2
							has_opinion = {
								target = ROOT
								value > 64
							}
						}
					}
					add_equipment_to_stockpile = { type = fighter_equipment_2 amount = 8 producer = USA }
					else = {
						if = {
							limit = {
								USA = {
									has_tech = fighter1
									has_opinion = {
										target = ROOT
										value > 44
									}
								}
							}
							add_equipment_to_stockpile = { type = fighter_equipment_1 amount = 8 producer = USA }
							else = {
								if = {
									limit = {
										USA = {
											has_tech = early_fighter
											has_opinion = {
												target = ROOT
												value > 24
											}
										}
									}
									add_equipment_to_stockpile = { type = fighter_equipment_0 amount = 8 producer = USA }
								}
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				USA = {
					has_tech = advanced_light_tank
					has_opinion = {
						target = ROOT
						value > 94
					}
				}
			}
			add_equipment_to_stockpile = { type = light_tank_equipment_3 amount = 8 producer = USA }
			else = {
				if = {
					limit = {
						USA = {
							has_tech = improved_light_tank
							has_opinion = {
								target = ROOT
								value > 84
							}
						}
					}
					add_equipment_to_stockpile = { type = light_tank_equipment_2 amount = 8 producer = USA }
					else = {
						if = {
							limit = {
								USA = {
									has_tech = basic_light_tank
									has_opinion = {
										target = ROOT
										value > 74
									}
								}
							}
							add_equipment_to_stockpile = { type = light_tank_equipment_1 amount = 8 producer = USA }
							else = {
								if = {
									limit = {
										USA = {
											has_tech = gwtank
											has_opinion = {
												target = ROOT
												value > 64
											}
										}
									}
									add_equipment_to_stockpile = { type = gw_tank_equipment amount = 8 producer = USA }
								}
							}
						}
					}
				}
			}
		}
	}
	if = {
		limit = {
			FRA = {
				is_puppet = no
				has_capitulated = no
			}
			has_global_flag = KMT_FRA_agreed_to_assist
		}
		if = {
			limit = {
				FRA = {
					has_tech = advanced_infantry_weapons
					has_opinion = {
						target = ROOT
						value > 84
					}
				}
			}
			add_equipment_to_stockpile = { type = infantry_equipment_3 amount = 200 producer = FRA }
			else = {
				if = {
					limit = {
						FRA = {
							has_tech = improved_infantry_weapons
							has_opinion = {
								target = ROOT
								value > 64
							}
						}
					}
					add_equipment_to_stockpile = { type = infantry_equipment_2 amount = 200 producer = FRA }
					else = {
						if = {
							limit = {
								FRA = {
									has_tech = infantry_weapons1
									has_opinion = {
										target = ROOT
										value > 64
									}
								}
							}
							add_equipment_to_stockpile = { type = infantry_equipment_1 amount = 200 producer = FRA }
							else = {
								add_equipment_to_stockpile = { type = infantry_equipment_0 amount = 200 producer = FRA }
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				FRA = {
					has_tech = tech_support
					has_opinion = {
						target = ROOT
						value > 14
					}
				}
			}
			add_equipment_to_stockpile = { type = support_equipment_1 amount = 100 producer = FRA }
		}
		if = {
			limit = {
				FRA = {
					has_tech = fighter3
					has_opinion = {
						target = ROOT
						value > 84
					}
				}
			}
			add_equipment_to_stockpile = { type = fighter_equipment_3 amount = 8 producer = FRA }
			else = {
				if = {
					limit = {
						FRA = {
							has_tech = fighter2
							has_opinion = {
								target = ROOT
								value > 64
							}
						}
					}
					add_equipment_to_stockpile = { type = fighter_equipment_2 amount = 8 producer = FRA }
					else = {
						if = {
							limit = {
								FRA = {
									has_tech = fighter1
									has_opinion = {
										target = ROOT
										value > 44
									}
								}
							}
							add_equipment_to_stockpile = { type = fighter_equipment_1 amount = 8 producer = FRA }
							else = {
								if = {
									limit = {
										FRA = {
											has_tech = early_fighter
											has_opinion = {
												target = ROOT
												value > 24
											}
										}
									}
									add_equipment_to_stockpile = { type = fighter_equipment_0 amount = 8 producer = FRA }
								}
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				FRA = {
					has_tech = advanced_light_tank
					has_opinion = {
						target = ROOT
						value > 94
					}
				}
			}
			add_equipment_to_stockpile = { type = light_tank_equipment_3 amount = 8 producer = FRA }
			else = {
				if = {
					limit = {
						FRA = {
							has_tech = improved_light_tank
							has_opinion = {
								target = ROOT
								value > 84
							}
						}
					}
					add_equipment_to_stockpile = { type = light_tank_equipment_2 amount = 8 producer = FRA }
					else = {
						if = {
							limit = {
								FRA = {
									has_tech = basic_light_tank
									has_opinion = {
										target = ROOT
										value > 74
									}
								}
							}
							add_equipment_to_stockpile = { type = light_tank_equipment_1 amount = 8 producer = FRA }
							else = {
								if = {
									limit = {
										FRA = {
											has_tech = gwtank
											has_opinion = {
												target = ROOT
												value > 64
											}
										}
									}
									add_equipment_to_stockpile = { type = gw_tank_equipment amount = 8 producer = FRA }
								}
							}
						}
					}
				}
			}
		}
	}
	if = {
		limit = {
			GER = {
				is_puppet = no
				has_capitulated = no
			}
			has_global_flag = KMT_german_approved_global
		}
		if = {
			limit = {
				GER = {
					has_tech = advanced_infantry_weapons
					has_opinion = {
						target = ROOT
						value > 84
					}
				}
			}
			add_equipment_to_stockpile = { type = infantry_equipment_3 amount = 200 producer = GER }
			else = {
				if = {
					limit = {
						GER = {
							has_tech = improved_infantry_weapons
							has_opinion = {
								target = ROOT
								value > 64
							}
						}
					}
					add_equipment_to_stockpile = { type = infantry_equipment_2 amount = 200 producer = GER }
					else = {
						if = {
							limit = {
								GER = {
									has_tech = infantry_weapons1
									has_opinion = {
										target = ROOT
										value > 64
									}
								}
							}
							add_equipment_to_stockpile = { type = infantry_equipment_1 amount = 200 producer = GER }
							else = {
								add_equipment_to_stockpile = { type = infantry_equipment_0 amount = 200 producer = GER }
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				GER = {
					has_tech = tech_support
					has_opinion = {
						target = ROOT
						value > 14
					}
				}
			}
			add_equipment_to_stockpile = { type = support_equipment_1 amount = 100 producer = GER }
		}
		if = {
			limit = {
				GER = {
					has_tech = fighter3
					has_opinion = {
						target = ROOT
						value > 84
					}
				}
			}
			add_equipment_to_stockpile = { type = fighter_equipment_3 amount = 8 producer = GER }
			else = {
				if = {
					limit = {
						GER = {
							has_tech = fighter2
							has_opinion = {
								target = ROOT
								value > 64
							}
						}
					}
					add_equipment_to_stockpile = { type = fighter_equipment_2 amount = 8 producer = GER }
					else = {
						if = {
							limit = {
								GER = {
									has_tech = fighter1
									has_opinion = {
										target = ROOT
										value > 44
									}
								}
							}
							add_equipment_to_stockpile = { type = fighter_equipment_1 amount = 8 producer = GER }
							else = {
								if = {
									limit = {
										GER = {
											has_tech = early_fighter
											has_opinion = {
												target = ROOT
												value > 24
											}
										}
									}
									add_equipment_to_stockpile = { type = fighter_equipment_0 amount = 8 producer = GER }
								}
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				GER = {
					has_tech = advanced_light_tank
					has_opinion = {
						target = ROOT
						value > 94
					}
				}
			}
			add_equipment_to_stockpile = { type = light_tank_equipment_3 amount = 8 producer = GER }
			else = {
				if = {
					limit = {
						GER = {
							has_tech = improved_light_tank
							has_opinion = {
								target = ROOT
								value > 84
							}
						}
					}
					add_equipment_to_stockpile = { type = light_tank_equipment_2 amount = 8 producer = GER }
					else = {
						if = {
							limit = {
								GER = {
									has_tech = basic_light_tank
									has_opinion = {
										target = ROOT
										value > 74
									}
								}
							}
							add_equipment_to_stockpile = { type = light_tank_equipment_1 amount = 8 producer = GER }
							else = {
								if = {
									limit = {
										GER = {
											has_tech = gwtank
											has_opinion = {
												target = ROOT
												value > 64
											}
										}
									}
									add_equipment_to_stockpile = { type = gw_tank_equipment amount = 8 producer = GER }
								}
							}
						}
					}
				}
			}
		}
	}
}

KMT_evacuate_industry_to_the_rear = { 
	set_temp_variable = {
		var = af_to_move
		value = arms_factory_level
	}
	if = {
		limit = {
			check_variable = { af_to_move > 5 }
		}
		multiply_variable = {
			var = af_to_move
			value = global.CHI_industrial_evacuations_amount_factor3
		}
		else = {
			if = {
				limit = {
					check_variable = { af_to_move > 4 }
				}
				multiply_variable = {
					var = af_to_move
					value = global.CHI_industrial_evacuations_amount_factor2
				}
				else = {
					if = {
						limit = {
							check_variable = { af_to_move > 3 }
						}
						multiply_variable = {
							var = af_to_move
							value = global.CHI_industrial_evacuations_amount_factor
						}
					}
				}
			}
		}
	}
	
	set_temp_variable = {
		var = ic_to_move
		value = industrial_complex_level
	}
	if = {
		limit = {
			check_variable = { ic_to_move > 5 }
		}
		multiply_variable = {
			var = ic_to_move
			value = global.CHI_industrial_evacuations_amount_factor3
		}
		else = {
			if = {
				limit = {
					check_variable = { ic_to_move > 4 }
				}
				multiply_variable = {
					var = ic_to_move
					value = global.CHI_industrial_evacuations_amount_factor2
				}
				else = {
					if = {
						limit = {
							check_variable = { ic_to_move > 3 }
						}
						multiply_variable = {
							var = ic_to_move
							value = global.CHI_industrial_evacuations_amount_factor
						}
					}
				}
			}
		}
	}
	remove_building = {
		type = arms_factory
		level = af_to_move
	}
	remove_building = {
		type = industrial_complex
		level = ic_to_move
	}

	#Move AF
	ROOT = {
		if = {
			limit = {
				605 = {
					OR = {
						AND = {
							is_fully_controlled_by = ROOT
							is_owned_by = ROOT
							any_neighbor_state = {
								is_controlled_by = ROOT
							}
						}
						AND = {
							CONTROLLER = {
								has_idea = cg_warlords
								has_war_together_with = ROOT
								has_full_control_of_state = PREV
								owns_state = PREV
							}
							any_neighbor_state = {
								CONTROLLER = {
									NOT = { has_war_with = ROOT }
									NOT = { has_war_with = PREV }
								}
							}
						}
					}
					free_building_slots = {
						building = arms_factory
						size > 2
						include_locked = yes
					}
				}
			}
			605 = {
				add_extra_state_shared_building_slots = af_to_move
				add_building_construction = {
					type = arms_factory
					level = af_to_move
					instant_build = yes
				}
				CONTROLLER = { set_country_flag = CHI_industrial_evacuations_moved_AF }
			}
			else = {
				if = {
					limit = {
						748 = {
							OR = {
								AND = {
									is_fully_controlled_by = ROOT
									is_owned_by = ROOT
									any_neighbor_state = {
										is_controlled_by = ROOT
									}
								}
								AND = {
									CONTROLLER = {
										has_idea = cg_warlords
										has_war_together_with = ROOT
										has_full_control_of_state = PREV
										owns_state = PREV
									}
									any_neighbor_state = {
										CONTROLLER = {
											NOT = { has_war_with = ROOT }
											NOT = { has_war_with = PREV }
										}
									}
								}
							}
							free_building_slots = {
								building = arms_factory
								size > 2
								include_locked = yes
							}
						}
					}
					748 = {
						add_extra_state_shared_building_slots = af_to_move
						add_building_construction = {
							type = arms_factory
							level = af_to_move
							instant_build = yes
						}
						CONTROLLER = { set_country_flag = CHI_industrial_evacuations_moved_AF }
					}
					else = {
						if = {
							limit = {
								603 = {
									OR = {
										AND = {
											is_fully_controlled_by = ROOT
											is_owned_by = ROOT
											any_neighbor_state = {
												is_controlled_by = ROOT
											}
										}
										AND = {
											CONTROLLER = {
												has_idea = cg_warlords
												has_war_together_with = ROOT
												has_full_control_of_state = PREV
												owns_state = PREV
											}
											any_neighbor_state = {
												CONTROLLER = {
													NOT = { has_war_with = ROOT }
													NOT = { has_war_with = PREV }
												}
											}
										}
									}
									free_building_slots = {
										building = arms_factory
										size > 2
										include_locked = yes
									}
								}
							}
							603 = {
								add_extra_state_shared_building_slots = af_to_move
								add_building_construction = {
									type = arms_factory
									level = af_to_move
									instant_build = yes
								}
								CONTROLLER = { set_country_flag = CHI_industrial_evacuations_moved_AF }
							}
							else = {
								random_owned_controlled_state = {
									prioritize = { 605 748 603 }
									limit = {
										OR = {
											is_fully_controlled_by = ROOT
											CONTROLLER = {
												has_idea = cg_warlords
												has_war_together_with = ROOT
												has_full_control_of_state = PREV
											}
										}
										any_neighbor_state = {
											OR = {
												is_controlled_by = ROOT
												CONTROLLER = {
													has_idea = cg_warlords
													has_war_together_with = ROOT
													has_full_control_of_state = PREV
												}
											}
										}
										free_building_slots = {
											building = arms_factory
											size > 2
											include_locked = yes
										}
									}
									add_extra_state_shared_building_slots = af_to_move
									add_building_construction = {
										type = arms_factory
										level = af_to_move
										instant_build = yes
									}
									CONTROLLER = { set_country_flag = CHI_industrial_evacuations_moved_AF }
								}
							}
						}
					}
				}
			}
		}

		#If no states are really safe or all safe are filled
		#Move to random controlled state
		if = {
			limit = {
				NOT = { has_country_flag = CHI_industrial_evacuations_moved_AF }
				NOT = {
					any_state = {
						OR = {
							AND = {
								is_fully_controlled_by = ROOT
								is_owned_by = ROOT
							}
							CONTROLLER = {
								has_idea = cg_warlords
								has_war_together_with = ROOT
								has_full_control_of_state = PREV
								owns_state = PREV
							}
						}
						any_neighbor_state = {
							OR = {
								is_controlled_by = ROOT
								CONTROLLER = {
									NOT = { has_war_with = ROOT }
									NOT = { has_war_with = PREV }
								}
							}
						}
						free_building_slots = {
							building = arms_factory
							size > 2
							include_locked = yes
						}
					}
				}
			}
			random_owned_controlled_state = {
				prioritize = { 605 748 603 }
				limit = {
					OR = {
						AND = {
							is_controlled_by = ROOT
							is_owned_by = ROOT
						}
						CONTROLLER = {
							has_idea = cg_warlords
							has_war_together_with = ROOT
							owns_state = PREV
						}
					}
					free_building_slots = {
						building = arms_factory
						size > 2
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = af_to_move
				add_building_construction = {
					type = arms_factory
					level = af_to_move
					instant_build = yes
				}
			}
		}
		clr_country_flag = CHI_industrial_evacuations_moved_AF


		#Move IC
		if = {
			limit = {
				605 = {
					OR = {
						AND = {
							is_fully_controlled_by = ROOT
							is_owned_by = ROOT
							any_neighbor_state = {
								is_controlled_by = ROOT
							}
						}
						AND = {
							CONTROLLER = {
								has_idea = cg_warlords
								has_war_together_with = ROOT
								has_full_control_of_state = PREV
								owns_state = PREV
							}
							any_neighbor_state = {
								CONTROLLER = {
									NOT = { has_war_with = ROOT }
									NOT = { has_war_with = PREV }
								}
							}
						}
					}
					free_building_slots = {
						building = industrial_complex
						size > 2
						include_locked = yes
					}
				}
			}
			605 = {
				add_extra_state_shared_building_slots = ic_to_move
				add_building_construction = {
					type = industrial_complex
					level = ic_to_move
					instant_build = yes
				}
				CONTROLLER = { set_country_flag = CHI_industrial_evacuations_moved_IC }
			}
			else = {
				if = {
					limit = {
						748 = {
							OR = {
								AND = {
									is_fully_controlled_by = ROOT
									is_owned_by = ROOT
									any_neighbor_state = {
										is_controlled_by = ROOT
									}
								}
								AND = {
									CONTROLLER = {
										has_idea = cg_warlords
										has_war_together_with = ROOT
										has_full_control_of_state = PREV
										owns_state = PREV
									}
									any_neighbor_state = {
										CONTROLLER = {
											NOT = { has_war_with = ROOT }
											NOT = { has_war_with = PREV }
										}
									}
								}
							}
							free_building_slots = {
								building = industrial_complex
								size > 2
								include_locked = yes
							}
						}
					}
					748 = {
						add_extra_state_shared_building_slots = ic_to_move
						add_building_construction = {
							type = industrial_complex
							level = ic_to_move
							instant_build = yes
						}
						CONTROLLER = { set_country_flag = CHI_industrial_evacuations_moved_IC }
					}
					else = {
						if = {
							limit = {
								603 = {
									OR = {
										AND = {
											is_fully_controlled_by = ROOT
											is_owned_by = ROOT
											any_neighbor_state = {
												is_controlled_by = ROOT
											}
										}
										AND = {
											CONTROLLER = {
												has_idea = cg_warlords
												has_war_together_with = ROOT
												has_full_control_of_state = PREV
												owns_state = PREV
											}
											any_neighbor_state = {
												CONTROLLER = {
													NOT = { has_war_with = ROOT }
													NOT = { has_war_with = PREV }
												}
											}
										}
									}
									free_building_slots = {
										building = industrial_complex
										size > 2
										include_locked = yes
									}
								}
							}
							603 = {
								add_extra_state_shared_building_slots = ic_to_move
								add_building_construction = {
									type = industrial_complex
									level = ic_to_move
									instant_build = yes
								}
								CONTROLLER = { set_country_flag = CHI_industrial_evacuations_moved_IC }
							}
							else = {
								random_owned_controlled_state = {
									prioritize = { 605 748 603 }
									limit = {
										OR = {
											is_fully_controlled_by = ROOT
											CONTROLLER = {
												has_idea = cg_warlords
												has_war_together_with = ROOT
												has_full_control_of_state = PREV
											}
										}
										any_neighbor_state = {
											OR = {
												is_controlled_by = ROOT
												CONTROLLER = {
													has_idea = cg_warlords
													has_war_together_with = ROOT
													has_full_control_of_state = PREV
												}
											}
										}
										free_building_slots = {
											building = industrial_complex
											size > 2
											include_locked = yes
										}
									}
									add_extra_state_shared_building_slots = ic_to_move
									add_building_construction = {
										type = industrial_complex
										level = ic_to_move
										instant_build = yes
									}
									CONTROLLER = { set_country_flag = CHI_industrial_evacuations_moved_IC }
								}
							}
						}
					}
				}
			}
		}

		#If no states are really safe or all safe are filled
		#Move to random controlled state
		if = {
			limit = {
				NOT = { has_country_flag = CHI_industrial_evacuations_moved_IC }
				NOT = {
					any_state = {
						OR = {
							AND = {
								is_fully_controlled_by = ROOT
								is_owned_by = ROOT
							}
							CONTROLLER = {
								has_idea = cg_warlords
								has_war_together_with = ROOT
								has_full_control_of_state = PREV
								owns_state = PREV
							}
						}
						any_neighbor_state = {
							OR = {
								is_controlled_by = ROOT
								CONTROLLER = {
									NOT = { has_war_with = ROOT }
									NOT = { has_war_with = PREV }
								}
							}
						}
						free_building_slots = {
							building = industrial_complex
							size > 2
							include_locked = yes
						}
					}
				}
			}
			random_owned_controlled_state = {
				prioritize = { 605 748 603 }
				limit = {
					OR = {
						AND = {
							is_controlled_by = ROOT
							is_owned_by = ROOT
						}
						CONTROLLER = {
							has_idea = cg_warlords
							has_war_together_with = ROOT
							owns_state = PREV
						}
					}
					free_building_slots = {
						building = industrial_complex
						size > 2
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = ic_to_move
				add_building_construction = {
					type = industrial_complex
					level = ic_to_move
					instant_build = yes
				}
			}
		}
		clr_country_flag = CHI_industrial_evacuations_moved_IC
	}		
}

PRC_guerrilla_cell_sabotage_effect = {
	set_temp_variable = { var = PRC_target_state_cell_strength_temp value = PRC_state_guerrilla_cell_strength }
	set_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = 0 }
	if = {
		limit = {
			check_variable = { PRC_target_state_infra_level_temp < PRC_target_state_cell_strength_temp }
		}
		add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = infrastructure_level }
		damage_building = {
			type = infrastructure
			damage = 10
		}
		subtract_from_temp_variable = { var = PRC_target_state_cell_strength_temp value = PRC_target_state_infra_level_temp }
		if = {
			limit = {
				arms_factory > 0
				check_variable = { PRC_target_state_cell_strength_temp > 1 }
			}
			damage_building = {
				type = arms_factory
				damage = 1
			}
			add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = 2 }
			subtract_from_temp_variable = { var = PRC_target_state_cell_strength_temp value = 2 }
			if = {
				limit = {
					industrial_complex > 0
					check_variable = { PRC_target_state_cell_strength_temp > 1 }
				}
				damage_building = {
					type = industrial_complex
					damage = 1
				}
				add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = 2 }
				subtract_from_temp_variable = { var = PRC_target_state_cell_strength_temp value = 2 }
				if = {
					limit = {
						dockyard > 0
						check_variable = { PRC_target_state_cell_strength_temp > 1 }
					}
					damage_building = {
						type = dockyard
						damage = 1
					}
					add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = 2 }
				}
			}
		}
		else = {
			if = {
				limit = {
					check_variable = { PRC_target_state_cell_strength_temp < 3 }
				}
				add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = PRC_target_state_cell_strength_temp }
				damage_building = {
					type = infrastructure
					damage = 2
				}
				else = {
					if = {
						limit = {
							check_variable = { PRC_target_state_cell_strength_temp < 4 }
						}
						add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = PRC_target_state_cell_strength_temp }
						damage_building = {
							type = infrastructure
							damage = 3
						}
						else = {
							if = {
								limit = {
									check_variable = { PRC_target_state_cell_strength_temp < 5 }
								}
								add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = PRC_target_state_cell_strength_temp }
								damage_building = {
									type = infrastructure
									damage = 4
								}
								else = {
									if = {
										limit = {
											check_variable = { PRC_target_state_cell_strength_temp < 6 }
										}
										add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = PRC_target_state_cell_strength_temp }
										damage_building = {
											type = infrastructure
											damage = 5
										}
										else = {
											if = {
												limit = {
													check_variable = { PRC_target_state_cell_strength_temp < 7 }
												}
												add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = PRC_target_state_cell_strength_temp }
												damage_building = {
													type = infrastructure
													damage = 6
												}
												else = {
													if = {
														limit = {
															check_variable = { PRC_target_state_cell_strength_temp < 8 }
														}
														add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = PRC_target_state_cell_strength_temp }
														damage_building = {
															type = infrastructure
															damage = 7
														}
														else = {
															if = {
																limit = {
																	check_variable = { PRC_target_state_cell_strength_temp < 9 }
																}
																add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = PRC_target_state_cell_strength_temp }
																damage_building = {
																	type = infrastructure
																	damage = 8
																}
																else = {
																	if = {
																		limit = {
																			check_variable = { PRC_target_state_cell_strength_temp < 10 }
																		}
																		add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = PRC_target_state_cell_strength_temp }
																		damage_building = {
																			type = infrastructure
																			damage = 9
																		}
																		add_to_temp_variable = { var = PRC_target_state_cell_strength_cost_temp value = PRC_target_state_cell_strength_temp }
																		else = {
																			damage_building = {
																				type = infrastructure
																				damage = 10
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	if = {
		limit = {
			air_base > 0
		}
		damage_building = {
			type = air_base
			damage = 1
		}
	}
	set_temp_variable = { var = PRC_target_minus_cell_strength_amount value = PRC_target_state_cell_strength_cost_temp }
	subtract_from_variable = { var = PRC_state_guerrilla_cell_strength value = PRC_target_minus_cell_strength_amount }
	custom_effect_tooltip = PRC_target_state_minus_cell_strength_tt
}

PRC_uprise_in_state_effect = {
	if = {
		limit = {
			check_variable = { PRC_state_guerrilla_cell_strength > 39 }
		}
		meta_effect = {
			text = {
				ROOT = { load_oob = "PRC_guerrilla_[STATE_ID]_40" }
			}
			STATE_ID = "[?This.KMT_dcat_sprite_id_num]"
		}
		set_temp_variable = { var = PRC_state_cell_uprise_cost value = 40 }
		else = {
			if = {
				limit = {
					check_variable = { PRC_state_guerrilla_cell_strength > 29 }
				}
				meta_effect = {
					text = {
						ROOT = { load_oob = "PRC_guerrilla_[STATE_ID]_30" }
					}
					STATE_ID = "[?This.KMT_dcat_sprite_id_num]"
				}
				set_temp_variable = { var = PRC_state_cell_uprise_cost value = 30 }
				else = {
					if = {
						limit = {
							check_variable = { PRC_state_guerrilla_cell_strength > 19 }
						}
						meta_effect = {
							text = {
								ROOT = { load_oob = "PRC_guerrilla_[STATE_ID]_20" }
							}
							STATE_ID = "[?This.KMT_dcat_sprite_id_num]"
						}
						set_temp_variable = { var = PRC_state_cell_uprise_cost value = 20 }
						else = {
							meta_effect = {
								text = {
									ROOT = { load_oob = "PRC_guerrilla_[STATE_ID]_10" }
								}
								STATE_ID = "[?This.KMT_dcat_sprite_id_num]"
							}
							set_temp_variable = { var = PRC_state_cell_uprise_cost value = 10 }
						}
					}
				}
			}
		}
	}
}

KMT_ps_update_pop_sup = {

	set_variable = { global.KMT_highest_pop_sup = 0 }

	every_country = {
		limit = {
			is_valid_power_struggle_participant = yes
		}
		set_variable = { KMT_ps_total_pop_sup = 0 }
	}

	every_country = {
		limit = {
			is_valid_power_struggle_participant = yes
		}
		every_state = {
			limit = {
				has_state_flag = KMT_china_inalienable_part
				check_variable = { THIS.KMT_pop_support@PREV > 0 }
			}
			add_to_variable = { PREV.KMT_ps_total_pop_sup = THIS.KMT_pop_support@PREV }
			if = {
				limit = {
					any_country = { is_in_array = { THIS.KMT_ps_alliance_array = PREV.PREV }}
				}
				random_country = {
					limit = { is_in_array = { THIS.KMT_ps_alliance_array = PREV.PREV }}
					add_to_variable = { THIS.KMT_ps_total_pop_sup = PREV.KMT_pop_support@PREV.PREV }
				}
			}
		}
	}
	
	every_country = {
		limit = {
			is_valid_power_struggle_participant = yes
		}
		if = {
			limit = { check_variable = { THIS.KMT_ps_total_pop_sup > global.KMT_highest_pop_sup }}
			every_country = {
				limit = { has_country_flag = KMT_ps_highest_pop_sup_tag }
				clr_country_flag = KMT_ps_highest_pop_sup_tag
			}
			set_country_flag = KMT_ps_highest_pop_sup_tag
			set_variable = { global.KMT_highest_pop_sup = THIS.KMT_ps_total_pop_sup }
		}
	}
}

KMT_ps_update_auth_sup = {

	set_variable = { global.KMT_total_auth_support_cap_temp = 0 }
	
			
	every_state = {
		limit = {
			has_state_flag = KMT_china_inalienable_part
			owner = {
			}
		}
		add_to_variable = { global.KMT_total_auth_support_cap_temp = KMT_power_struggle_auth_support_total }
	}

	every_country = {
		limit = {
			is_chinese_nations = yes
		}
		set_variable = { KMT_total_auth_support_temp = 0 }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
		}
		add_to_variable = { event_target:KMT_central_gov_tag.KMT_total_auth_support_temp = KMT_CHI_auth_support }
	}
			
	event_target:KMT_central_gov_tag = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
			owner = { tag = GXC }
		}
		add_to_variable = { GXC.KMT_total_auth_support_temp = KMT_GXC_auth_support }
	}
	
	GXC = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
		}
		add_to_variable = { QIA.KMT_total_auth_support_temp = KMT_QIA_auth_support }
	}
	
	QIA = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
		}
		add_to_variable = { SCC.KMT_total_auth_support_temp = KMT_SCC_auth_support }
	}
	
	SCC = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
		}
		add_to_variable = { SDC.KMT_total_auth_support_temp = KMT_SDC_auth_support }
	}
	
	SDC = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
		}
		add_to_variable = { SIK.KMT_total_auth_support_temp = KMT_SIK_auth_support }
	}
	
	SIK = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
		}
		add_to_variable = { SKC.KMT_total_auth_support_temp = KMT_SKC_auth_support }
	}
	
	SKC = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
		}
		add_to_variable = { SHX.KMT_total_auth_support_temp = KMT_SHX_auth_support }
	}
	
	SHX = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
		}
		add_to_variable = { XIA.KMT_total_auth_support_temp = KMT_XIA_auth_support }
	}
	
	XIA = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
		}
		add_to_variable = { XSM.KMT_total_auth_support_temp = KMT_XSM_auth_support }
	}
	
	XSM = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
		}
		add_to_variable = { YUN.KMT_total_auth_support_temp = KMT_YUN_auth_support }
	}
	
	YUN = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
		}
		add_to_variable = { YUT.KMT_total_auth_support_temp = KMT_YUT_auth_support }
	}
	
	YUT = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
	
	every_state = {
		limit = {
			is_core_of = event_target:KMT_central_gov_tag
		}
		add_to_variable = { ZXL.KMT_total_auth_support_temp = KMT_ZXL_auth_support }
	}
	
	ZXL = { 
		set_variable = { KMT_total_auth_support_debug = KMT_total_auth_support_temp }
		divide_variable = { KMT_total_auth_support_temp = global.KMT_total_auth_support_cap_temp }
		multiply_variable = { KMT_total_auth_support_temp = 100 }
		set_variable = { KMT_total_auth_support = KMT_total_auth_support_temp }
	}
}

KMT_ps_update_ip = {
	every_country = {
		limit = {
			is_valid_power_struggle_participant = yes
			NOT = { tag = PRC }
		}
		set_variable = { KMT_ps_available_ip_max = 0 }
		if = {
			limit = {
				tag = event_target:KMT_central_gov_tag
			}
			add_to_variable = { KMT_ps_available_ip_max = 4 }
		}else = {
			add_to_variable = { KMT_ps_available_ip_max = 1 }
		}
		set_temp_variable = { KMT_temp_stabi = stability }
		multiply_temp_variable = { KMT_temp_stabi = 10 }
		subtract_from_temp_variable = { KMT_temp_stabi = 0.5 }
		round_temp_variable = KMT_temp_stabi
		add_to_variable = { KMT_ps_available_ip_max = KMT_temp_stabi }
		if = {
			limit = {
				is_in_array = { global.KMT_ps_alliance_leaders = THIS }
			}
			subtract_from_variable = { KMT_ps_available_ip_max = 1 }
		}
		if = {
			limit = {
				check_variable = { KMT_ps_ip_spent > KMT_ps_available_ip_max }
			}
			country_event = { id = loop.5 }
		}
	}
}

#requires a country={state={}} scope and declaration of KMT_pop_support_increment@PREV first
#requires event target  KMT_ps_pop_sup_temp_state
#This effect is advised to be called in the state scope
#KMT_pop_support_increment@PREV should be declared in the state scope, or in the way as state_id.KMT_pop_support_increment@PREV
KMT_increase_pop_supportTHIS = {	
	custom_effect_tooltip = KMT_increase_pop_sup_in_state_tt													
	hidden_effect = {
		add_to_variable = { KMT_pop_support@PREV = KMT_pop_support_increment@PREV }
		#event_target:KMT_central_gov_tag = { country_event = { id = loop.7 }}		#test event
		set_variable = { KMT_ps_pop_sup_temp_state.KMT_state_sup_total = 0 }		#reset total amount of support
		every_country = {															#add up amount of support of every valid participant to reflect new total amount of support	
			limit = {
				check_variable = { KMT_ps_pop_sup_temp_state.KMT_pop_support@THIS > 0 } 								#PREV returns state, THIS returns country tag
			}
			add_to_variable = { KMT_ps_pop_sup_temp_state.KMT_state_sup_total = KMT_ps_pop_sup_temp_state.KMT_pop_support@THIS }		#PREV returns state, THIS returns country tag
			#THIS = { save_global_event_target_as = KMT_test_tag_2 }
			#event_target:KMT_central_gov_tag = { country_event = { id = loop.10 }}		#test event
		}
		if = {
			limit = {
				check_variable = { KMT_ps_pop_sup_temp_state.KMT_state_sup_total > 100 }		#total amount of support > 100, exception
			}
			#set_variable = { global.KMT_state_sup_total_test = KMT_ps_pop_sup_temp_state.KMT_state_sup_total}
			state_event = { id = loop.6 } 												#prevent pop_sup go over 100
			#event_target:KMT_central_gov_tag = { country_event = { id = loop.9 }}
		}
	}
}


KMT_deduct_pop_supportROOT = {	
	custom_effect_tooltip = KMT_reduce_pop_sup_in_state_tt
	hidden_effect = {
		if = {
			limit = {
				check_variable = { KMT_pop_support_reduction@ROOT > KMT_pop_support@ROOT }
			}
			set_variable = { KMT_pop_support_reduction@ROOT > KMT_pop_support@ROOT }
		}
		subtract_from_variable = { KMT_pop_support@ROOT = KMT_pop_support_reduction@ROOT }
	}
}

KMT_mck_break_free_ideo_pop = {	
	set_temp_variable = { MCK_temp_neut = party_popularity@neutrality }
	set_temp_variable = { MCK_temp_fasc = party_popularity@fascism }
	set_temp_variable = { MCK_temp_demo = party_popularity@democratic }
	set_temp_variable = { MCK_temp_comm = party_popularity@communism }
	hidden_effect = {
		country_event = { id = wd.1 }
	}
	if = {
		limit = {
			check_variable = { MCK_temp_govnt = 1 }
		}
		set_politics = {
			ruling_party = neutrality
		}
		else = {
			if = {
				limit = {
					check_variable = { MCK_temp_govnt = 2 }
				}
				set_politics = {
					ruling_party = fascism
				}
				else = {
					if = {
						limit = {
							check_variable = { MCK_temp_govnt = 3 }
						}
						set_politics = {
							ruling_party = communism
						}
						else = {
							if = {
								limit = {
									check_variable = { MCK_temp_govnt = 4 }
								}
								set_politics = {
									ruling_party = democratic
								}
							}
						}
					}
				}
			}
		}
	}

	if = {
		limit = {
			has_government = neutrality
		}
		add_popularity = {
			ideology = neutrality
			popularity = -1
		}
		add_popularity = {
			ideology = democratic
			popularity = MCK_temp_demo
		}
		add_popularity = {
			ideology = communism
			popularity = MCK_temp_comm
		}
		add_popularity = {
			ideology = fascism
			popularity = MCK_temp_fasc
		}		
		add_popularity = {
			ideology = neutrality
			popularity = MCK_temp_neut
		}
		else = {
			if = {
				limit = {
					has_government = democratic
				}
				add_popularity = {
					ideology = democratic
					popularity = -1
				}
				add_popularity = {
					ideology = communism
					popularity = MCK_temp_comm
				}
				add_popularity = {
					ideology = fascism
					popularity = MCK_temp_fasc
				}		
				add_popularity = {
					ideology = neutrality
					popularity = MCK_temp_neut
				}
				add_popularity = {
					ideology = democratic
					popularity = MCK_temp_demo
				}
				else = {
					if = {
						limit = {
							has_government = fascism
						}
						add_popularity = {
							ideology = fascism
							popularity = -1
						}	
						add_popularity = {
							ideology = communism
							popularity = MCK_temp_comm
						}
						add_popularity = {
							ideology = neutrality
							popularity = MCK_temp_neut
						}
						add_popularity = {
							ideology = democratic
							popularity = MCK_temp_demo
						}
						add_popularity = {
							ideology = fascism
							popularity = MCK_temp_fasc
						}	
						else = {
							if = {
								limit = {
									has_government = communism
								}
								add_popularity = {
									ideology = communism
									popularity = -1
								}
								add_popularity = {
									ideology = neutrality
									popularity = MCK_temp_neut
								}
								add_popularity = {
									ideology = democratic
									popularity = MCK_temp_demo
								}
								add_popularity = {
									ideology = fascism
									popularity = MCK_temp_fasc
								}		
								add_popularity = {
									ideology = communism
									popularity = MCK_temp_comm
								}
							}
						}
					}
				}
			}
		}
	}
}

update_reconc_cost = {
	set_variable = { MCK_RFP_reconciliation_cost = MCK_RFP_readinessV }
	multiply_variable = { MCK_RFP_reconciliation_cost = MCK_RFP_mood }
	add_to_variable = { MCK_RFP_reconciliation_cost = MCK_RFP_reconciliation_cost_base }
}

#require definition of MCK_suspicion_increase
add_suspicion = {
	set_temp_variable = { MCK_temp_suspicion = MCK_suspicion }
	add_to_temp_variable = { MCK_temp_suspicion = MCK_suspicion_increase }
	if = {
		limit = {
			check_variable = { MCK_temp_suspicion > 9 }
		}
		increase_jap_awareness = yes
		subtract_from_variable = { MCK_suspicion = 10 }
		else = {
			add_to_variable = { MCK_suspicion = MCK_suspicion_increase }
		}
	}
}

#require definition of MCK_RFP_mood_increase
add_mood = {
	add_to_variable = { MCK_RFP_mood = MCK_RFP_mood_increase }
	if = {
		limit = {
			check_variable = { MCK_RFP_mood > 6 }
		}
		set_variable = { MCK_RFP_mood = 6 }
	}
	if = {
		limit = {
			check_variable = { MCK_RFP_mood < -6 }
		}
		set_variable = { MCK_RFP_mood = -6 }
	}
}

#require prior declaration of temp variable PRC.PRC_mao_power_change
change_mao_power = {
	custom_effect_tooltip = PRC_change_mao_power_tt
	add_to_variable = { PRC.PRC_ips_mao_support = PRC.PRC_mao_power_change }
	if = {
		limit = {
			check_variable = { PRC.PRC_ips_mao_support < 0 }
		}
		set_variable = { PRC.PRC_ips_mao_support = 0 }
	}
}

#require prior declaration of temp variable PRC.PRC_wang_power_change
change_wang_power = {
	custom_effect_tooltip = PRC_change_wang_power_tt
	add_to_variable = { PRC.PRC_ips_wang_support = PRC.PRC_wang_power_change }
	if = {
		limit = {
			check_variable = { PRC.PRC_ips_wang_support < 0 }
		}
		set_variable = { PRC.PRC_ips_wang_support = 0 }
	}
}

#require prior declaration of temp variable PRC.PRC_zhang_power_change
change_zhang_power = {
	if = {
		limit = {
			NOT = { has_country_flag = PRC_absconded }
		}
		custom_effect_tooltip = PRC_change_zhang_power_tt
		add_to_variable = { PRC.PRC_ips_zhang_support = PRC.PRC_zhang_power_change }
		if = {
			limit = {
				check_variable = { PRC.PRC_ips_zhang_support < 0 }
			}
			set_variable = { PRC.PRC_ips_zhang_support = 0 }
		}
	}
}

KMT_zxlprc_border_war = {
	random_state = {
		limit = {
			OWNER = {
				tag = ZXL
				has_full_control_of_state = PREV
			}
			any_neighbor_state = {
				OWNER = { 
					tag = PRC 
					has_full_control_of_state = PREV
				}
			}
		}
		save_global_event_target_as = KMT_zxl_offensive_state
		random_state = {
			limit = {
				any_neighbor_state = {
					state = PREV.PREV
				}
				OWNER = { 
					tag = PRC
					has_full_control_of_state = PREV
				}
			}
			save_global_event_target_as = KMT_prc_defensive_state
		}
	}
	start_border_war = {
		change_state_after_war = no
		minimum_duration_in_days = 20
		combat_width = 160
		attacker = {
			state = event_target:KMT_zxl_offensive_state
			num_provinces = 4
			on_win = kmt.604
			on_lose = kmt.605
			on_cancel = kmt.606
			leader_score = {
				base = 1
				modifier = {
					has_id = 3612
					add = 10
				}
			}
			modifier = -0.25
		}
		
		defender = {
			state = event_target:KMT_prc_defensive_state
			num_provinces = 3
			on_win = kmt.604
			on_lose = kmt.605
			on_cancel = kmt.606
			terrain_factor = 1.5
		}
	}
}

PRC_update_long_march_debuff = {
	set_variable = { PRC.PRC_long_march_debuff_conscription = -0.0095 }
	multiply_variable = { PRC.PRC_long_march_debuff_conscription = PRC.PRC_long_march_debuff_base }
	set_variable = { PRC.PRC_long_march_debuff_conscription_factor = -0.015 }
	multiply_variable = { PRC.PRC_long_march_debuff_conscription_factor = PRC.PRC_long_march_debuff_base }
	set_variable = { PRC.PRC_long_march_debuff_reinforce_rate = -0.02 }
	multiply_variable = { PRC.PRC_long_march_debuff_reinforce_rate = PRC.PRC_long_march_debuff_base }
	set_variable = { PRC.PRC_long_march_debuff_attack = -0.01 }
	multiply_variable = { PRC.PRC_long_march_debuff_attack = PRC.PRC_long_march_debuff_base }
	set_variable = { PRC.PRC_long_march_debuff_defense = -0.01 }
	multiply_variable = { PRC.PRC_long_march_debuff_defense = PRC.PRC_long_march_debuff_base }
	set_variable = { PRC.PRC_long_march_debuff_planning_speed = -0.025 }
	multiply_variable = { PRC.PRC_long_march_debuff_planning_speed = PRC.PRC_long_march_debuff_base }
	set_variable = { PRC.PRC_long_march_debuff_training_time = 0.1 }
	multiply_variable = { PRC.PRC_long_march_debuff_training_time = PRC.PRC_long_march_debuff_base }
	set_variable = { PRC.PRC_long_march_debuff_stability = -0.05 }
	multiply_variable = { PRC.PRC_long_march_debuff_stability = PRC.PRC_long_march_debuff_base }
	set_variable = { PRC.PRC_long_march_debuff_war_support = -0.01 }
	multiply_variable = { PRC.PRC_long_march_debuff_war_support = PRC.PRC_long_march_debuff_base }
}

PRC_lower_long_march_lvl_by1 = {
	if = {
		limit = {
			check_variable = { PRC.PRC_long_march_debuff_base > 0 }
		}
		if = {
			limit = {
				check_variable = { PRC.PRC_long_march_debuff_base > 1 }
			}
			custom_effect_tooltip = PRC_lower_long_march_lvl_by1_tt
		}else = {
			custom_effect_tooltip = PRC_remove_long_march_debuff_tt
			hidden_effect = {
				remove_dynamic_modifier = { modifier = PRC_long_march_debuff }
			}
		}
		subtract_from_variable = { PRC.PRC_long_march_debuff_base = 1 }
		PRC_update_long_march_debuff = yes
	}
}

update_cg_loyalty = {
	hidden_effect = {
		random_country = {
			limit = {
				tag = event_target:KMT_central_gov_tag
			}
			every_country = {
				limit = {
					is_valid_power_struggle_participant = yes
					NOT = { tag = PREV }
				}
				set_variable = { THIS.KMT_ps_loyalty@KMT_central_gov_tag = THIS.KMT_ps_loyalty@PREV }
			}
		}
	}
}

#requires declaration of THIS.KMT_ps_loyalty_change variable(not temp_variable)
KMT_ps_change_loyalty = {
	hidden_effect = {
		if = {
			limit = { has_event_target = KMT_central_gov_tag }
			random_country = {
				limit = { tag = event_target:KMT_central_gov_tag }
				add_to_variable = { PREV.KMT_ps_loyalty@THIS = PREV.KMT_ps_loyalty_change }
				if = {
					limit = { check_variable = { PREV.KMT_ps_loyalty@THIS < -100 }}
					set_variable = { PREV.KMT_ps_loyalty@THIS = -100 }
				}
				if = {
					limit = { check_variable = { PREV.KMT_ps_loyalty@THIS > 100 }}
					set_variable = { PREV.KMT_ps_loyalty@THIS = 100 }
				}
			}
		}
	}
}

update_cg_inalienable_parts = {
	hidden_effect = {
		clear_array = global.KMT_cg_inalienable_parts
		random_country = {
			limit = {
				tag = event_target:KMT_central_gov_tag
			}
			every_state = {
				limit = {
					is_in_array = { PREV.KMT_considered_inalienable_parts = THIS }
				}
				add_to_array = { global.KMT_cg_inalienable_parts = THIS }
			}
		}
	}
}