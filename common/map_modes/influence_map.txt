# # scripted map modes can be used to add new map modes to game_map_mode_factions
# # 
# # example:
# # 
scripted_map_modes = {
    influence_map_mode = {
        top = {
            type = country

            color = {
                FROM = {
					set_temp_variable = { alpha = 1.0 }
                }
                if = { #SOV
                    limit = {
                        SOV = { has_government = communism }
                        SOV = { is_subject = no}
                        FROM = {
                            OR = {
                                is_subject_of = SOV
                                is_puppet_of = SOV
                                has_country_flag = comeconmember 
                                tag = SOV
                            AND = {
                                is_guaranteed_by = SOV
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            } 
                            AND = {
                                is_in_faction_with = SOV
                                SOV = { is_faction_leader = yes}
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }                                                             
                            AND = {                                                           
                            has_opinion = {
                                target = SOV
                                value > 80
                            }    
                            OR = {
                            is_in_faction = no
                            is_in_faction_with = SOV
                            }
                            }                                  
                            }
                        }
                    }
                    set_temp_variable = { red = 0.63 }
                    set_temp_variable = { green = 0.18 }
                    set_temp_variable = { blue = 0.25 }
                }

                else_if = { #USA
                    limit = {       
                        USA = { has_government = democratic }
                        USA = { is_subject = no}
                        FROM = {
                            NOT = {
                                has_country_flag = comeconmember
                                tag = SOV
                                has_government = communism
                            }                                              
                            OR = {
                                is_subject_of = USA
                                is_puppet_of = USA 
                            AND = {
                                is_guaranteed_by = USA
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }
                            AND = {
                                is_in_faction_with = USA
                                USA = { is_faction_leader = yes}
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }                                                              
                            AND = {                                                           
                            has_opinion = {
                                target = USA
                                value > 80
                            }    
                            OR = {
                            is_in_faction = no
                            is_in_faction_with = USA
                            }                            
                            }              
                                has_idea = RI_marshall_plan_reciever
                                tag = USA
                                has_completed_focus = cw_democratic_foreign_policy
                                has_completed_focus = GER3_a_powerful_ally_against_communism
                            }
                        }
                    }
                    set_temp_variable = { red = 0.13 }
                    set_temp_variable = { green = 0.18 }
                    set_temp_variable = { blue = 0.85 }
                }

                else_if = { #ENG
                    limit = {
                            ENG = {
                                 OR = {                           
                                AND = {
                                is_in_faction = yes
                                is_faction_leader = yes 
                                }
                                AND = {
                                RAJ = {is_puppet_of = ENG}
                                is_subject = no
                                }
                                 }
                            }
                        FROM = {
                            OR = {
                                tag = ENG
                                is_subject_of = ENG                                
                                is_puppet_of = ENG
                            AND = {
                                is_guaranteed_by = ENG
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }
                            AND = {
                                is_in_faction_with = ENG
                                ENG = { is_faction_leader = yes}
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }                                      
                            AND = {                                                           
                            has_opinion = {
                                target = ENG
                                value > 80
                            }    
                            is_in_faction = no
                            } 
                            is_in_faction_with = ENG
                            }
                        }
                    }
                    set_temp_variable = { red = 1 }
                    set_temp_variable = { green = 0 }
                    set_temp_variable = { blue = 0 }
                }
   else_if = { #GER
                    limit = {
                        OR = {
                            GER = {
                            OR = {
                                is_faction_leader = yes
                                is_in_faction = no
                            }
                                is_subject = no

                            }
                        }
                        FROM = {
                            OR = {
                                is_puppet_of = GER
                                is_subject_of = GER
                                tag = GER
                            AND = {
                                is_guaranteed_by = GER
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }
                            AND = {
                                is_in_faction_with = GER
                                GER = { is_faction_leader = yes}
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }                                      
                            AND = {                                                           
                            has_opinion = {
                                target = GER
                                value > 80
                            }    
                            is_in_faction = no                            
                            }                            
                            is_in_faction_with = GER                            
                            }
                        }
                    }
                    set_temp_variable = { red = 0.35 }
                    set_temp_variable = { green = 0.34 }
                    set_temp_variable = { blue = 0.35 }
                }
   else_if = { #JAP
                    limit = {
                        OR = {
                            JAP = {
                            OR = {
                                is_faction_leader = yes
                                is_in_faction = no
                            }
                                is_subject = no
                                owns_state = 555
                                OR = {
                                owns_state = 745
                                MAN = {
                                    owns_state = 745
                                }
                                }
                            }
                        }
                        FROM = {
                            OR = {
                                tag = JAP
                                is_subject_of = JAP
                                is_puppet_of = JAP
                            AND = {
                                is_guaranteed_by = JAP
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }
                            AND = {
                                is_in_faction_with = JAP
                                JAP = { is_faction_leader = yes}
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }                                      
                            AND = {                                                           
                            has_opinion = {
                                target = JAP
                                value > 80
                            }    
                            is_in_faction = no
                            }
                            is_in_faction_with = JAP
                            }
                        }
                    }
                    set_temp_variable = { red = 1 } 
                    set_temp_variable = { green = 1 }
                    set_temp_variable = { blue = 1 }
                }
   else_if = { #CHI
                    limit = {
                        OR = {
                            CHI = {
                            OR = {
                                is_faction_leader = yes
                                is_in_faction = no
                            }
                                is_subject = no
                            controls_state = 613
                            }
                        }
                        FROM = {
                            OR = {
                                tag = CHI
                                is_puppet_of = CHI
                                is_subject_of = CHI
                            AND = {
                                is_guaranteed_by = CHI
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }
                            AND = {
                                is_in_faction_with = CHI
                                CHI = { is_faction_leader = yes}
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }                                     
                            AND = {                                                           
                            has_opinion = {
                                target = CHI
                                value > 80
                            }    
                            is_in_faction = no
                            }
                            is_in_faction_with = CHI
                            }
                        }
                    }
                    set_temp_variable = { red = .51 }
                    set_temp_variable = { green = .51 }
                    set_temp_variable = { blue = .23 }
                }           
   else_if = { #PRC
                    limit = {
                        OR = {
                            PRC = {
                            OR = {
                                is_faction_leader = yes
                                is_in_faction = no
                            }
                                is_subject = no
                            controls_state = 608
                            }
                        }
                        FROM = {
                            OR = {
                                tag = PRC
                                is_subject_of = PRC
                                is_puppet_of = PRC
                            AND = {
                                is_guaranteed_by = PRC
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }
                            AND = {
                                is_in_faction_with = PRC
                                PRC = { is_faction_leader = yes}
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }                                    
                            AND = {                                                           
                            has_opinion = {
                                target = PRC
                                value > 80
                            }    
                            is_in_faction = no
                            }
                            is_in_faction_with = PRC
                            }
                        }
                    }
                    set_temp_variable = { red = .73 }
                    set_temp_variable = { green = .31 }
                    set_temp_variable = { blue = .51 }
                }
  else_if = { #ITA
                    limit = {
                        OR = {
                            GRE = {is_puppet_of = ITA} 
                            AND = {
                             GRE = {is_in_faction_with = ITA}
                            ITA = {
                                is_faction_leader = yes #They need be be out of the axis and own greace
                            }
                            }
                        }
                        FROM = {
                            OR = {
                                tag = ITA
                                is_subject_of = ITA
                                is_puppet_of = ITA
                            AND = {
                                is_guaranteed_by = ITA
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }
                            AND = {
                                is_in_faction_with = ITA
                                ITA = { is_faction_leader = yes}
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }                                    
                            AND = {                                                           
                            has_opinion = {
                                target = ITA
                                value > 80
                            }    
                            is_in_faction = no
                            }
                            is_in_faction_with = ITA
                            }
                        }
                    }
                    set_temp_variable = { red = .13 }
                    set_temp_variable = { green = .91 }
                    set_temp_variable = { blue = .1 }
                }                
   else_if = { #RUS
                    limit = {
                        OR = {
                            PRC = {
                            OR = {
                                is_faction_leader = yes
                                is_in_faction = no
                            }
                                is_subject = no
                            }
                        }
                        FROM = {
                            OR = {
                                tag = RUS
                                is_subject_of = RUS
                                is_puppet_of = RUS
                            AND = {
                                is_guaranteed_by = RUS
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }
                            AND = {
                                is_in_faction_with = RUS
                                RUS = { is_faction_leader = yes}
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }                                    
                            AND = {                                                           
                            has_opinion = {
                                target = RUS
                                value > 80
                            }    
                            is_in_faction = no
                            }
                            is_in_faction_with = RUS
                            }
                        }
                    }
                    set_temp_variable = { red = .13 }
                    set_temp_variable = { green = .61 }
                    set_temp_variable = { blue = .1 }
                }   
 else_if = { #RUE
                    limit = {
                        OR = {
                            PRC = {
                            OR = {
                                is_faction_leader = yes
                                is_in_faction = no
                            }
                                is_subject = no
                            }
                        }
                        FROM = {
                            OR = {
                                tag = RUE
                                is_subject_of = RUE
                                is_puppet_of = RUE
                            AND = {
                                is_guaranteed_by = RUE
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }
                            AND = {
                                is_in_faction_with = RUE
                                RUE = { is_faction_leader = yes}
                                OR = {
                                has_idea = superstate_size1
                                has_idea = superstate_size2
                                }
                            }                                    
                            AND = {                                                           
                            has_opinion = {
                                target = RUE
                                value > 80
                            }    
                            is_in_faction = no
                            }
                            is_in_faction_with = RUE
                            }
                        }
                    }
                    set_temp_variable = { red = .13 }
                    set_temp_variable = { green = .61 }
                    set_temp_variable = { blue = .1 }
                }                                                                                              
            }
            thickness = yes
        }
    

        bottom = {
			type = country

			color = {
				set_temp_variable = { alpha = 0.4 }
				set_temp_variable = { thickness = 10.0 }
				set_temp_variable = { red = 0.0 }
				set_temp_variable = { green = 0.0 }
				set_temp_variable = { blue = 0.0 }
			}

			thickness = yes

			targets = {
				targets = { ROOT }
			}
		}
        far_text = faction
		near_text = country
        update_daily = yes
    }
}