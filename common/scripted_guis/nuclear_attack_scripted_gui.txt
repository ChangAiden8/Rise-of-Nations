scripted_gui = {

	nuclear_attack_ui = {
		context_type = selected_state_context
		parent_window_token = selected_state_view 
		window_name = "nuclear_attack_ui_window"
		visible = {
			ROOT = {
				has_country_flag = show_nuclear_ui
			}
		}
		triggers = {
			
			launch_nuke_attack_click_enabled = {
				ROOT = {
					if = {
						limit = {
							check_variable = { missile_type = 1}
						}
						if = {
							limit = {
								has_tech = RON_SRBM1
							}
							set_temp_variable = { range = 300 }
						}
						if = {
							limit = {
								has_tech = RON_SRBM2
							}
							set_temp_variable = { range = 400 }
						}
						if = {
							limit = {
								has_tech = RON_SRBM3
							}
							set_temp_variable = { range = 550 }
						}
						if = {
							limit = {
								has_tech = RON_SRBM4
							}
							set_temp_variable = { range = 600 }
						}
						if = {
							limit = {
								has_tech = RON_SRBM5
							}
							set_temp_variable = { range = 650 }
						}
						if = {
							limit = {
								has_tech = RON_SRBM6
							}
							set_temp_variable = { range = 700 }
						}
						
					}

					if = {
						limit = {
							OR = {
								check_variable = {
									warhead_type = 1
								}
								check_variable = {
									warhead_type = 0
								}
							}
						}
						subtract_from_temp_variable = {
							range = 50
						}
					}
					
					any_state = {
						CONTROLLER = {
							OR = {
								tag = ROOT
								is_ally_with = ROOT

								AND = {
									has_war_together_with = ROOT #自国と共闘している国家（同陣営内？）
									NOT = { has_war_with = ROOT } #自国と交戦していない
								}
							}
						}
						
						non_damaged_building_level = { building = rocket_site level > 0 }
						set_temp_variable = { range_hoi4 = range }
						divide_temp_variable = { range_hoi4 = 4.4}
						check_variable = { distance_to@PREV.PREV < var:range_hoi4}
					}
				}
			}
		}
		properties = {
			warhead_selected = {
				frame = ROOT.warhead_type
			}
		}
		effects = {
			warhead_selected_click = {
				ROOT = {
					
					if = {
						limit = {
							NOT = {
								has_country_flag = selecting_new_warhead
							}
						}
						set_country_flag = selecting_new_warhead
					}
					else = {
						
						clr_country_flag = selecting_new_warhead
					}

					if = {
						limit = {
							has_country_flag = selecting_new_missile
						}
						clr_country_flag = selecting_new_missile
					}
				}
			}
			nuclear_missile_selected_click = {
				ROOT = {
					
					if = {
						limit = {
							NOT = {
								has_country_flag = selecting_new_missile
							}
						}
						set_country_flag = selecting_new_missile
					}
					else = {
						
						clr_country_flag = selecting_new_missile
					}

					if = {
						limit = {
							has_country_flag = selecting_new_warhead
						}
						clr_country_flag = selecting_new_warhead
					}
				}
			}
			launch_nuke_attack_click = {
				CONTROLLER = {
					for_each_scope_loop = { array = owned_states
						if = {
							limit = {
								ROOT = {
									any_state = {
										CONTROLLER = {
											OR = {
												tag = ROOT
												is_ally_with = ROOT
												AND = {
													has_war_together_with = ROOT #自国と共闘している国家（同陣営内？）
													NOT = { has_war_with = ROOT } #自国と交戦していない
												}
											}
										}
										non_damaged_building_level = { building = rocket_site level > 0 }
										check_variable = { distance_to@PREV.PREV < 600}
									}
								}
							}

							ROOT = { launch_nuke = { state = PREV use_nuke = no } } 
						}
						
						
					}
				}
			}
		
		}
		
	}
	nuclear_attack_ui_warhead_selection={

		context_type = selected_state_context
		parent_window_name = "nuclear_attack_container"
		window_name = "nuclear_warhead_choice_holder"
		visible = {
			ROOT = {
				has_country_flag = selecting_new_warhead
			}
		}
		triggers = {
			warhead_1_click_enabled = {
				ROOT = {
					has_tech = nukes
				}
			}
			warhead_2_click_enabled = {
				ROOT = {
					has_tech = RON_Thermonuclear_Bomb
				}
			}
			warhead_3_click_enabled = {
				ROOT = {
					has_tech = RON_Thermonuclear_Bomb3
				}
			}
			warhead_4_click_enabled = {
				ROOT = {
					has_tech = RON_Neutron_Bomb
				}
			}
			warhead_5_click_enabled = {
				ROOT = {
					has_tech = RON_Antimatter_Bomb
				}
			}
		}
		effects = {
			warhead_1_click = {
				ROOT = {
					set_variable = { warhead_type = 1 }
					if = {
						limit = {
							NOT = {
								has_country_flag = selecting_new_warhead
							}
						}
						set_country_flag = selecting_new_warhead
					}
					else = {
						
						clr_country_flag = selecting_new_warhead
					}
				}
			}
			warhead_2_click = {
				ROOT = {
					set_variable = { warhead_type = 2 }
					if = {
						limit = {
							NOT = {
								has_country_flag = selecting_new_warhead
							}
						}
						set_country_flag = selecting_new_warhead
					}
					else = {
						
						clr_country_flag = selecting_new_warhead
					}
				}
			}
			warhead_3_click = {
				ROOT = {
					set_variable = { warhead_type = 3 }
					if = {
						limit = {
							NOT = {
								has_country_flag = selecting_new_warhead
							}
						}
						set_country_flag = selecting_new_warhead
					}
					else = {
						
						clr_country_flag = selecting_new_warhead
					}
				}
			}
			warhead_4_click = {
				ROOT = {
					set_variable = { warhead_type = 4 }
					if = {
						limit = {
							NOT = {
								has_country_flag = selecting_new_warhead
							}
						}
						set_country_flag = selecting_new_warhead
					}
					else = {
						
						clr_country_flag = selecting_new_warhead
					}
				}
			}
			warhead_5_click = {
				ROOT = {
					set_variable = { warhead_type = 5 }
					if = {
						limit = {
							NOT = {
								has_country_flag = selecting_new_warhead
							}
						}
						set_country_flag = selecting_new_warhead
					}
					else = {
						
						clr_country_flag = selecting_new_warhead
					}
				}
			}
		}
	}
	nuclear_attack_ui_missile_selection ={
		context_type = selected_state_context
		parent_window_name = "nuclear_attack_container"
		window_name = "nuclear_missile_choice_holder"
		visible = {
			ROOT = {
				has_country_flag = selecting_new_missile
			} 
		}
		triggers = {
			nuclear_missile_1_click_enabled = {
				ROOT = {
					has_tech = RON_SRBM1
				}
			}
			nuclear_missile_3_click_enabled = {
				ROOT = {
					has_tech = RON_IRBM1
				}
			}
			nuclear_missile_4_click_enabled = {
				ROOT = {
					has_tech = RON_ICBM1
				}
			}
		}
		effects = {
			nuclear_missile_1_click = {
				ROOT = {
					set_variable = { missile_type = 1 }
					if = {
						limit = {
							NOT = {
								has_country_flag = selecting_new_missile
							}
						}
						set_country_flag = selecting_new_missile
					}
					else = {
						
						clr_country_flag = selecting_new_missile
					}
				}
			}
			nuclear_missile_2_click = {
				ROOT = {
					set_variable = { missile_type = 2 }
					if = {
						limit = {
							NOT = {
								has_country_flag = selecting_new_missile
							}
						}
						set_country_flag = selecting_new_missile
					}
					else = {
						
						clr_country_flag = selecting_new_missile
					}
				}
			}
			nuclear_missile_3_click = {
				ROOT = {
					set_variable = { missile_type = 3 }
					if = {
						limit = {
							NOT = {
								has_country_flag = selecting_new_missile
							}
						}
						set_country_flag = selecting_new_missile
					}
					else = {
						
						clr_country_flag = selecting_new_missile
					}
				}
			}
			nuclear_missile_4_click = {
				ROOT = {
					set_variable = { missile_type = 4 }
					if = {
						limit = {
							NOT = {
								has_country_flag = selecting_new_missile
							}
						}
						set_country_flag = selecting_new_missile
					}
					else = {
						
						clr_country_flag = selecting_new_missile
					}
				}
			}
		}
	}
}	

